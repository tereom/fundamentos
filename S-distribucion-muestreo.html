<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Sección 5 Estimación y distribución de muestreo | EST-46111: Fundamentos de Estadística con Remuestreo</title>
  <meta name="description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2020." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Sección 5 Estimación y distribución de muestreo | EST-46111: Fundamentos de Estadística con Remuestreo" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2020." />
  <meta name="github-repo" content="tereom/fundamentos" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Sección 5 Estimación y distribución de muestreo | EST-46111: Fundamentos de Estadística con Remuestreo" />
  
  <meta name="twitter:description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2020." />
  

<meta name="author" content="Teresa Ortiz (001), Alfredo Garbuno (002), Felipe González" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pruebas-de-hipótesis.html"/>
<link rel="next" href="intervalos-de-confianza-y-remuestreo.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Fundamentos de Estadística con Remuestreo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#temario"><i class="fa fa-check"></i>Temario</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#evaluación"><i class="fa fa-check"></i>Evaluación</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html"><i class="fa fa-check"></i><b>1</b> Principios de visualización</a><ul>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#el-cuarteto-de-ascombe"><i class="fa fa-check"></i>El cuarteto de Ascombe</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#introducción"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#teoría-de-visualización-de-datos"><i class="fa fa-check"></i>Teoría de visualización de datos</a><ul>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#principios-generales-del-diseño-analítico"><i class="fa fa-check"></i>Principios generales del diseño analítico</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#técnicas-de-visualización"><i class="fa fa-check"></i>Técnicas de visualización</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#indicadores-de-calidad-gráfica"><i class="fa fa-check"></i>Indicadores de calidad gráfica</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#factor-de-engaño-y-chartjunk"><i class="fa fa-check"></i>Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#pequeños-múltiplos-y-densidad-gráfica"><i class="fa fa-check"></i>Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#tinta-de-datos"><i class="fa fa-check"></i>Tinta de datos</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#decoración"><i class="fa fa-check"></i>Decoración</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#percepción-de-escala"><i class="fa fa-check"></i>Percepción de escala</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#ejemplo-gráfica-de-minard"><i class="fa fa-check"></i>Ejemplo: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html"><i class="fa fa-check"></i><b>2</b> Análisis exploratorio</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#el-papel-de-la-exploración-en-el-análisis-de-datos"><i class="fa fa-check"></i>El papel de la exploración en el análisis de datos</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#algunos-conceptos-básicos"><i class="fa fa-check"></i>Algunos conceptos básicos</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#media-y-desviación-estándar"><i class="fa fa-check"></i>Media y desviación estándar</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#ejemplos"><i class="fa fa-check"></i>Ejemplos</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#precios-de-casas"><i class="fa fa-check"></i>Precios de casas</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#prueba-enlace"><i class="fa fa-check"></i>Prueba Enlace</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#estados-y-calificaciones-en-sat"><i class="fa fa-check"></i>Estados y calificaciones en SAT</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#tablas-de-conteos"><i class="fa fa-check"></i>Tablas de conteos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#loess"><i class="fa fa-check"></i>Loess</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#ajustando-curvas-loess"><i class="fa fa-check"></i>Ajustando curvas loess</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#series-de-tiempo"><i class="fa fa-check"></i>Series de tiempo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html"><i class="fa fa-check"></i><b>3</b> Tipos de estudio y experimentos</a><ul>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#motivación"><i class="fa fa-check"></i>Motivación</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#proceso-generador-de-datos"><i class="fa fa-check"></i>Proceso Generador de Datos</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#ejemplo-prevalencia-de-anemia"><i class="fa fa-check"></i>Ejemplo: Prevalencia de anemia</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#muestreo-aleatorio"><i class="fa fa-check"></i>Muestreo aleatorio</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#pero-si-no-podemos-hacer-muestreo-aleatorio"><i class="fa fa-check"></i>Pero si no podemos hacer muestreo aleatorio?</a><ul>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#ejemplo-policías-y-tráfico"><i class="fa fa-check"></i>Ejemplo: Policías y tráfico</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#el-estimador-estándar"><i class="fa fa-check"></i>El estimador estándar</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#experimentos-tradicionales"><i class="fa fa-check"></i>Experimentos tradicionales</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#bloqueo"><i class="fa fa-check"></i>Bloqueo</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#variables-desconocidas"><i class="fa fa-check"></i>Variables desconocidas</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#aleatorizando-el-tratamiento"><i class="fa fa-check"></i>Aleatorizando el tratamiento</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#resumen-selección-de-unidades-y-tratamiento"><i class="fa fa-check"></i>Resumen: selección de unidades y tratamiento</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#asignación-natural-del-tratamiento"><i class="fa fa-check"></i>Asignación natural del tratamiento</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html"><i class="fa fa-check"></i><b>4</b> Pruebas de hipótesis</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#comparación-con-poblaciones-de-referencia"><i class="fa fa-check"></i>Comparación con poblaciones de referencia</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#comparando-distribuciones"><i class="fa fa-check"></i>Comparando distribuciones</a></li>
<li><a href="pruebas-de-hipótesis.html#prueba-de-permutaciones-y-el-lineup">Prueba de permutaciones y el <em>lineup</em></a></li>
<li><a href="pruebas-de-hipótesis.html#comparaciones-usando-lineup-continuación">Comparaciones usando <em>lineup</em> (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-permutaciones-para-proporciones"><i class="fa fa-check"></i>Prueba de permutaciones para proporciones</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#pruebas-de-hipótesis-tradicionales"><i class="fa fa-check"></i>Pruebas de hipótesis tradicionales</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#tomadores-de-té-continuación"><i class="fa fa-check"></i>Tomadores de té (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#pruebas-de-permutación-implementación"><i class="fa fa-check"></i>Pruebas de permutación: Implementación</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-tiempos-de-fusión"><i class="fa fa-check"></i>Ejemplo: tiempos de fusión</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-tiempos-de-fusión-continuación"><i class="fa fa-check"></i>Ejemplo: tiempos de fusión (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#separación-de-grupos"><i class="fa fa-check"></i>Separación de grupos</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#avispas-opcional"><i class="fa fa-check"></i>Avispas (opcional)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#la-crisis-de-replicabilidad"><i class="fa fa-check"></i>La “crisis de replicabilidad”</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#el-jardín-de-los-senderos-que-se-bifurcan"><i class="fa fa-check"></i>El jardín de los senderos que se bifurcan</a></li>
<li><a href="pruebas-de-hipótesis.html#ejemplo-decisiones-de-análisis-y-valores-p">Ejemplo: decisiones de análisis y valores <em>p</em></a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#alternativas-o-soluciones"><i class="fa fa-check"></i>Alternativas o soluciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html"><i class="fa fa-check"></i><b>5</b> Estimación y distribución de muestreo</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-precios-de-casas"><i class="fa fa-check"></i>Ejemplo: precios de casas</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#distribución-de-muestreo"><i class="fa fa-check"></i>Distribución de muestreo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#más-ejemplos"><i class="fa fa-check"></i>Más ejemplos</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#el-error-estándar"><i class="fa fa-check"></i>El error estándar</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-valor-de-casas"><i class="fa fa-check"></i>Ejemplo: valor de casas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#calculando-la-distribución-de-muestreo"><i class="fa fa-check"></i>Calculando la distribución de muestreo</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#teorema-central-del-límite"><i class="fa fa-check"></i>Teorema central del límite</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#normalidad-y-gráficas-de-cuantiles-normales"><i class="fa fa-check"></i>Normalidad y gráficas de cuantiles normales</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#prueba-de-hipótesis-de-normalidad"><i class="fa fa-check"></i>Prueba de hipótesis de normalidad</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#más-del-teorema-central-del-límite"><i class="fa fa-check"></i>Más del Teorema central del límite</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html"><i class="fa fa-check"></i><b>6</b> Intervalos de confianza y remuestreo</a><ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-introductorio"><i class="fa fa-check"></i>Ejemplo introductorio</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#la-idea-del-bootstrap"><i class="fa fa-check"></i>La idea del bootstrap</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#el-principio-de-plug-in"><i class="fa fa-check"></i>El principio de plug-in</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#discusión-propiedades-de-la-distribución-bootstrap"><i class="fa fa-check"></i>Discusión: propiedades de la distribución bootstrap</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#error-estándar-bootstrap-e-intervalos-normales"><i class="fa fa-check"></i>Error estándar bootstrap e intervalos normales</a><ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-tomadores-de-té-negro"><i class="fa fa-check"></i>Ejemplo: tomadores de té negro</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-inventario-de-casas-vendidas"><i class="fa fa-check"></i>Ejemplo: inventario de casas vendidas</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#calibración-de-intervalos-de-confianza"><i class="fa fa-check"></i>Calibración de intervalos de confianza</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#interpretación-de-intervalos-de-confianza"><i class="fa fa-check"></i>Interpretación de intervalos de confianza</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#intervalos-bootstrap-de-percentiles"><i class="fa fa-check"></i>Intervalos bootstrap de percentiles</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-para-dos-muestras"><i class="fa fa-check"></i>Bootstrap para dos muestras</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#datos-pareados"><i class="fa fa-check"></i>Datos pareados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-otras-estadísticas"><i class="fa fa-check"></i>Bootstrap y otras estadísticas</a><ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-estimadores-de-razón"><i class="fa fa-check"></i>Ejemplo: estimadores de razón</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-suavizadores"><i class="fa fa-check"></i>Ejemplo: suavizadores</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-estimadores-complejos-tablas-de-perfiles"><i class="fa fa-check"></i>Bootstrap y estimadores complejos: tablas de perfiles</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-muestras-complejas"><i class="fa fa-check"></i>Bootstrap y muestras complejas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#anáslisis-exploratorio"><i class="fa fa-check"></i>1. Anáslisis Exploratorio</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#loess"><i class="fa fa-check"></i>2. Loess</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#solución-series-de-tiempo"><i class="fa fa-check"></i>Solución: Series de tiempo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#tipos-de-estudio-y-pgd"><i class="fa fa-check"></i>3. Tipos de estudio y PGD</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#pruebas-de-hipótesis-visuales-y-permutación"><i class="fa fa-check"></i>4. Pruebas de hipótesis visuales y permutación</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#solución-pruebas-pareadas"><i class="fa fa-check"></i>Solución: Pruebas pareadas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#distribución-muestral-y-remuestreo"><i class="fa fa-check"></i>5. Distribución muestral y remuestreo</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#tcl-e-introducción-a-bootstrap"><i class="fa fa-check"></i>6. TCL e introducción a bootstrap</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#solución-y-discusión-de-media"><i class="fa fa-check"></i>Solución y discusión de media</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EST-46111: Fundamentos de Estadística con Remuestreo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="S:distribucion-muestreo" class="section level1">
<h1><span class="header-section-number">Sección 5</span> Estimación y distribución de muestreo</h1>
<p>En esta sección discutiremos cuál el objetivo general del proceso de estimación.
y cómo entender y manejar la variabilidad que se produce cuando aleatorizamos
la selección de las muestras que utilizamos para hacer análisis.</p>
<div id="ejemplo-precios-de-casas" class="section level2 unnumbered">
<h2>Ejemplo: precios de casas</h2>
<p>Supongamos que queremos conocer el valor total de las casas
que se vendieron recientemente en una zona
particular. Supondremos que tenemos un listado de las casas que se han
vendido recientemente, pero en ese listado no se encuentra el precio de venta.
Decidimos entonces tomar una muestra aleatoria de 100 de esas casas. Para esas
casas hacemos trabajo de campo para averiguar el precio de venta.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="S-distribucion-muestreo.html#cb95-1"></a>marco_casas &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/casas.csv&quot;</span>)</span>
<span id="cb95-2"><a href="S-distribucion-muestreo.html#cb95-2"></a><span class="kw">set.seed</span>(<span class="dv">841</span>)</span>
<span id="cb95-3"><a href="S-distribucion-muestreo.html#cb95-3"></a>muestra_casas &lt;-<span class="st"> </span><span class="kw">sample_n</span>(marco_casas, <span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb95-4"><a href="S-distribucion-muestreo.html#cb95-4"></a><span class="st">  </span><span class="kw">select</span>(id, nombre_zona, area_habitable_sup_m2, precio_miles)</span>
<span id="cb95-5"><a href="S-distribucion-muestreo.html#cb95-5"></a><span class="kw">sprintf</span>(<span class="st">&quot;Hay %0.0f casas en total, tomamos muestra de %0.0f&quot;</span>,</span>
<span id="cb95-6"><a href="S-distribucion-muestreo.html#cb95-6"></a>        <span class="kw">nrow</span>(marco_casas), <span class="kw">nrow</span>(muestra_casas))</span></code></pre></div>
<pre><code>## [1] &quot;Hay 1144 casas en total, tomamos muestra de 100&quot;</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="S-distribucion-muestreo.html#cb97-1"></a><span class="kw">head</span>(muestra_casas)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##      id nombre_zona area_habitable_sup_m2 precio_miles
##   &lt;dbl&gt; &lt;chr&gt;                       &lt;dbl&gt;        &lt;dbl&gt;
## 1   287 NAmes                       161.          159 
## 2   755 NAmes                        95.3         156 
## 3  1190 Gilbert                     168.          189 
## 4    36 NridgHt                     228.          309 
## 5    32 Sawyer                      114.          149.
## 6   538 NAmes                        80.3         111.</code></pre>
<p>Como tomamos una muestra aleatoria, intentamos estimar el valor
total de las casas que se vendieron expandiendo el total muestral, es decir
nuestro estimador <span class="math inline">\(\hat{t} = t(X_1,\ldots X_{100})\)</span> del total
poblacional <span class="math inline">\(t\)</span> es</p>
<p><span class="math display">\[\hat{t} = \frac{N}{n} \sum_{i=1}^{100} X_i = N\bar{x}\]</span></p>
<p>Esta función implementa el estimador:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="S-distribucion-muestreo.html#cb99-1"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(muestra_casas) <span class="co"># tamaño muestra</span></span>
<span id="cb99-2"><a href="S-distribucion-muestreo.html#cb99-2"></a>N &lt;-<span class="st"> </span><span class="kw">nrow</span>(marco_casas) <span class="co"># tamaño población</span></span>
<span id="cb99-3"><a href="S-distribucion-muestreo.html#cb99-3"></a>estimar_total &lt;-<span class="st"> </span><span class="cf">function</span>(muestra_casas, N){</span>
<span id="cb99-4"><a href="S-distribucion-muestreo.html#cb99-4"></a>  total_muestral &lt;-<span class="st"> </span><span class="kw">sum</span>(muestra_casas<span class="op">$</span>precio_miles)</span>
<span id="cb99-5"><a href="S-distribucion-muestreo.html#cb99-5"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(muestra_casas)</span>
<span id="cb99-6"><a href="S-distribucion-muestreo.html#cb99-6"></a>  <span class="co"># cada unidad de la muestra representa a N/n</span></span>
<span id="cb99-7"><a href="S-distribucion-muestreo.html#cb99-7"></a>  f_exp &lt;-<span class="st"> </span>N <span class="op">/</span><span class="st"> </span>n</span>
<span id="cb99-8"><a href="S-distribucion-muestreo.html#cb99-8"></a>  <span class="co"># estimador total es la expansión del total muestral</span></span>
<span id="cb99-9"><a href="S-distribucion-muestreo.html#cb99-9"></a>  estimador_total &lt;-<span class="st"> </span>f_exp <span class="op">*</span><span class="st"> </span>total_muestral</span>
<span id="cb99-10"><a href="S-distribucion-muestreo.html#cb99-10"></a>  res &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">total_muestra =</span> total_muestral,</span>
<span id="cb99-11"><a href="S-distribucion-muestreo.html#cb99-11"></a>         <span class="dt">factor_exp =</span> f_exp,</span>
<span id="cb99-12"><a href="S-distribucion-muestreo.html#cb99-12"></a>         <span class="dt">est_total_millones =</span> estimador_total <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>)</span>
<span id="cb99-13"><a href="S-distribucion-muestreo.html#cb99-13"></a>  res</span>
<span id="cb99-14"><a href="S-distribucion-muestreo.html#cb99-14"></a>}</span>
<span id="cb99-15"><a href="S-distribucion-muestreo.html#cb99-15"></a><span class="kw">estimar_total</span>(muestra_casas, N) <span class="op">%&gt;%</span></span>
<span id="cb99-16"><a href="S-distribucion-muestreo.html#cb99-16"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">where</span>(is.numeric), round, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   total_muestra factor_exp est_total_millones
##           &lt;dbl&gt;      &lt;dbl&gt;              &lt;dbl&gt;
## 1        18444.       11.4                211</code></pre>
<p>Sin embargo, si hubiéramos obtenido otra muestra, hubiéramos obtenido otra
estimación diferente. Por ejemplo:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="S-distribucion-muestreo.html#cb101-1"></a><span class="kw">estimar_total</span>(<span class="kw">sample_n</span>(marco_casas, <span class="dv">100</span>), N) <span class="op">%&gt;%</span></span>
<span id="cb101-2"><a href="S-distribucion-muestreo.html#cb101-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">where</span>(is.numeric), round, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   total_muestra factor_exp est_total_millones
##           &lt;dbl&gt;      &lt;dbl&gt;              &lt;dbl&gt;
## 1        17916.       11.4               205.</code></pre>
<p>El valor poblacional que buscamos estimar (nótese que en la práctica este no lo conocemos)
es:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="S-distribucion-muestreo.html#cb103-1"></a><span class="co"># multiplicar por 1000 para que sea en millones de dólares</span></span>
<span id="cb103-2"><a href="S-distribucion-muestreo.html#cb103-2"></a>total_pob &lt;-<span class="st"> </span><span class="kw">sum</span>(marco_casas <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(precio_miles)) <span class="op">/</span><span class="st"> </span><span class="dv">1000</span></span>
<span id="cb103-3"><a href="S-distribucion-muestreo.html#cb103-3"></a>total_pob</span></code></pre></div>
<pre><code>## [1] 209.7633</code></pre>
<p>Así que:</p>
<ul>
<li>Para algunas muestras esta estadística puede estar muy cercana al valor poblacional,
pero para otras puede estar más lejana.</li>
<li>Para entender qué tan buena es una estimación
particular, entonces, tenemos que entender <em>cuánta variabilidad hay de muestra a muestra</em>
debida a la aleatorización. Esto depende del diseño de la muestra y
de la población de precios de casas (que no conocemos).</li>
</ul>
</div>
<div id="distribución-de-muestreo" class="section level2 unnumbered">
<h2>Distribución de muestreo</h2>
<p>La distribución de muestreo de una estadística enumera los posibles resultados
que puede tomar esa estadística sobre todas las muestras posibles. Este es el concepto
básico para poder entender qué tan bien o mal estima un parámetro poblacional dado.</p>
<p>En nuestro ejemplo anterior de precio de casas, no podemos calcular todas las posibles
estimaciones bajo todas las posibles muestras, pero podemos aproximar
repitiendo una gran cantidad de veces el proceso de muestreo, como hicimos
al aproximar la distribución de permutaciones de estadísticas de prueba de las
secciones anteriores.</p>
<p>Empezamos repitiendo 10 veces y examinamos cómo varía nuestra estadística:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="S-distribucion-muestreo.html#cb105-1"></a>replicar_muestreo &lt;-<span class="st"> </span><span class="cf">function</span>(marco_casas, <span class="dt">m =</span> <span class="dv">500</span>, n){</span>
<span id="cb105-2"><a href="S-distribucion-muestreo.html#cb105-2"></a>  <span class="co"># n es el tamaño de muestra que se saca de marco_casas</span></span>
<span id="cb105-3"><a href="S-distribucion-muestreo.html#cb105-3"></a>  <span class="co"># m es el número de veces que repetimos el muestro de tamaño n</span></span>
<span id="cb105-4"><a href="S-distribucion-muestreo.html#cb105-4"></a>  resultados &lt;-<span class="st"> </span><span class="kw">map_df</span>(<span class="dv">1</span><span class="op">:</span>m,</span>
<span id="cb105-5"><a href="S-distribucion-muestreo.html#cb105-5"></a>      <span class="cf">function</span>(id) {</span>
<span id="cb105-6"><a href="S-distribucion-muestreo.html#cb105-6"></a>        <span class="kw">sample_n</span>(marco_casas, n) <span class="op">%&gt;%</span></span>
<span id="cb105-7"><a href="S-distribucion-muestreo.html#cb105-7"></a><span class="st">          </span><span class="kw">estimar_total</span>(N) </span>
<span id="cb105-8"><a href="S-distribucion-muestreo.html#cb105-8"></a>      }, <span class="dt">.id =</span> <span class="st">&quot;id_muestra&quot;</span>)</span>
<span id="cb105-9"><a href="S-distribucion-muestreo.html#cb105-9"></a>}</span>
<span id="cb105-10"><a href="S-distribucion-muestreo.html#cb105-10"></a><span class="kw">replicar_muestreo</span>(marco_casas, <span class="dt">m =</span> <span class="dv">10</span>, <span class="dt">n =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb105-11"><a href="S-distribucion-muestreo.html#cb105-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">where</span>(is.numeric), round, <span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb105-12"><a href="S-distribucion-muestreo.html#cb105-12"></a><span class="st">  </span><span class="kw">formatear_tabla</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">id_muestra</th>
<th align="right">total_muestra</th>
<th align="right">factor_exp</th>
<th align="right">est_total_millones</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">17594.8</td>
<td align="right">11.4</td>
<td align="right">201.3</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">17423.9</td>
<td align="right">11.4</td>
<td align="right">199.3</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">18444.3</td>
<td align="right">11.4</td>
<td align="right">211.0</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">17696.6</td>
<td align="right">11.4</td>
<td align="right">202.4</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">17275.8</td>
<td align="right">11.4</td>
<td align="right">197.6</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="right">17867.6</td>
<td align="right">11.4</td>
<td align="right">204.4</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="right">18450.8</td>
<td align="right">11.4</td>
<td align="right">211.1</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="right">18187.2</td>
<td align="right">11.4</td>
<td align="right">208.1</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="right">18604.2</td>
<td align="right">11.4</td>
<td align="right">212.8</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="right">19144.4</td>
<td align="right">11.4</td>
<td align="right">219.0</td>
</tr>
</tbody>
</table>
<p>Como vemos, hay variación considerable en nuestro estimador del total, pero
la estimación que haríamos con cualquiera de estas muestras no es muy mala. Ahora
examinamos un número más grande de simulaciones:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="S-distribucion-muestreo.html#cb106-1"></a>replicaciones_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">replicar_muestreo</span>(marco_casas, <span class="dt">m =</span> <span class="dv">1500</span>, <span class="dt">n =</span> <span class="dv">100</span>)</span></code></pre></div>
<p>Y el siguiente histograma nos dice qué podemos esperar de la variación de
nuestras estimadores, y donde es más probable que una estimación particular caiga:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="S-distribucion-muestreo.html#cb107-1"></a>graf_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(replicaciones_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> est_total_millones)) <span class="op">+</span></span>
<span id="cb107-2"><a href="S-distribucion-muestreo.html#cb107-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb107-3"><a href="S-distribucion-muestreo.html#cb107-3"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> total_pob, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb107-4"><a href="S-distribucion-muestreo.html#cb107-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Millones de dólares&quot;) +</span></span>
<span id="cb107-5"><a href="S-distribucion-muestreo.html#cb107-5"></a><span class="st">  scale_x_continuous(breaks = seq(180, 240, 10), limits = c(180, 240))</span></span>
<span id="cb107-6"><a href="S-distribucion-muestreo.html#cb107-6"></a><span class="st">graf_1</span></span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Con muy alta probabilidad el error no será de más de unos 30 millones de dólares
(o no más de 20% del valor poblacional).</p>
<div class="mathblock">
<p>
<strong>Definición</strong> Sea <span class="math inline"><span class="math inline">\(X_1, X_2, \ldots X_n\)</span></span> una muestra, y <span class="math inline"><span class="math inline">\(T = t(X_1, X_2, \ldots, X_n)\)</span></span> una estadística.
</p>
<p>
La <strong>distribución de muestreo</strong> de <span class="math inline"><span class="math inline">\(T\)</span></span> es la función de distribución de <span class="math inline"><span class="math inline">\(T\)</span></span>. Esta distribución es sobre todas las posibles muestras que se pueden obtener.
</p>
<p>
Cuando usamos <span class="math inline"><span class="math inline">\(T\)</span></span> para estimar algún parámetro poblacional <span class="math inline"><span class="math inline">\(\theta\)</span></span>, decimos informalmente que el estimador es <strong>preciso</strong> si su distribución de muestreo está muy concentrada alrededor del valor <span class="math inline"><span class="math inline">\(\theta\)</span></span> que queremos estimar.
</p>
</div>
<p>Si la distribución de muestreo está concentrada en un conjunto muy grande
o muy disperso, quiere decir que con alta probabilidad cuando obtengamos
nuestra muestra y calculemos nuestra estimación, el resultado estará lejano
del valor poblacional que nos interesa estimar.</p>
<p>Veamos qué pasa cuando hacemos la muestra más grande en nuestro ejemplo:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="S-distribucion-muestreo.html#cb108-1"></a>replicaciones_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">replicar_muestreo</span>(marco_casas, <span class="dt">m =</span> <span class="dv">1500</span>, <span class="dt">n =</span> <span class="dv">250</span>)</span></code></pre></div>
<p>Graficamos las dos distribuciones de muestreo juntas, y vemos cómo
con mayor muestra obtenemos un estimador más preciso, y sin considerar el costo,
preferimos el estimador <strong>mejor concentrado alrededor del valor que buscamos estimar</strong>.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="S-distribucion-muestreo.html#cb109-1"></a><span class="kw">library</span>(patchwork)</span>
<span id="cb109-2"><a href="S-distribucion-muestreo.html#cb109-2"></a>graf_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(replicaciones_<span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">x =</span> est_total_millones)) <span class="op">+</span></span>
<span id="cb109-3"><a href="S-distribucion-muestreo.html#cb109-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb109-4"><a href="S-distribucion-muestreo.html#cb109-4"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> total_pob, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb109-5"><a href="S-distribucion-muestreo.html#cb109-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Millones de dólares&quot;) +</span></span>
<span id="cb109-6"><a href="S-distribucion-muestreo.html#cb109-6"></a><span class="st">  scale_x_continuous(breaks = seq(180, 240, 10), limits = c(180, 240))</span></span>
<span id="cb109-7"><a href="S-distribucion-muestreo.html#cb109-7"></a><span class="st">graf_1 + graf_2</span></span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-10-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="comentario">
<p>
<strong>Observación</strong>: a veces este concepto se confunde la distribución poblacional de las <span class="math inline"><span class="math inline">\(X_i\)</span></span>. Esto es muy diferente.
</p>
</div>
<p>Por ejemplo, en nuestro caso, el histograma de la distribución de valores poblacionales es</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="S-distribucion-muestreo.html#cb110-1"></a><span class="kw">ggplot</span>(marco_casas, <span class="kw">aes</span>(<span class="dt">x =</span> precio_miles)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-12-1.png" width="480" style="display: block; margin: auto;" />
que en general no tiene ver mucho en escala o forma con la distribución de muestreo
de nuestro estimador del total.</p>
</div>
<div id="más-ejemplos" class="section level2 unnumbered">
<h2>Más ejemplos</h2>
<p>Podemos también considerar muestrear de poblaciones sintéticas o modelos
probabilísticos que usamos para modelar poblaciones reales.</p>
<p>Por ejemplo, supongamos que tomamos una muestra de tamaño 15 de la distribución
uniforme en <span class="math inline">\([0,1]\)</span>. Es decir, cada <span class="math inline">\(X_i\)</span> es un valor uniformemente distribuido
en <span class="math inline">\([0,1]\)</span>, y las <span class="math inline">\(X_i\)</span> se extraen independientemente unas de otras. Consideramos
dos estadísticas de interés:</p>
<ol style="list-style-type: decimal">
<li>La media muestral <span class="math inline">\(T_1(X) = \frac{1}{15}\sum_{i = 1}^{15} X_i\)</span></li>
<li>El cuantil 0.75 de la muestra <span class="math inline">\(T_2(X) = q_{0.75}(X)\)</span></li>
</ol>

<div class="ejercicio">
¿Cómo crees que se vean las distribuciones muestrales de estas estadísticas?
¿Alrededor de qué valores crees que concentren? ¿Crees que tendrán mucha o poca
dispersión? ¿Qué forma crees que tengan?
</div>

<p>Para el primer caso hacemos:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="S-distribucion-muestreo.html#cb111-1"></a><span class="co"># simular</span></span>
<span id="cb111-2"><a href="S-distribucion-muestreo.html#cb111-2"></a>replicar_muestreo_unif &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">est =</span> estimador_<span class="dv">1</span>, m, <span class="dt">n =</span> <span class="dv">15</span>){</span>
<span id="cb111-3"><a href="S-distribucion-muestreo.html#cb111-3"></a>  valores_est &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span>m, <span class="op">~</span><span class="st"> </span><span class="kw">est</span>(<span class="kw">runif</span>(n)))</span>
<span id="cb111-4"><a href="S-distribucion-muestreo.html#cb111-4"></a>  <span class="kw">tibble</span>(<span class="dt">id_muestra =</span> <span class="dv">1</span><span class="op">:</span>m, <span class="dt">estimacion =</span> valores_est)</span>
<span id="cb111-5"><a href="S-distribucion-muestreo.html#cb111-5"></a>}</span>
<span id="cb111-6"><a href="S-distribucion-muestreo.html#cb111-6"></a>sim_estimador_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">replicar_muestreo_unif</span>(mean, <span class="dv">4000</span>, <span class="dv">15</span>)</span>
<span id="cb111-7"><a href="S-distribucion-muestreo.html#cb111-7"></a><span class="co"># graficar aprox de distribución de muestreo</span></span>
<span id="cb111-8"><a href="S-distribucion-muestreo.html#cb111-8"></a><span class="kw">ggplot</span>(sim_estimador_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> estimacion)) <span class="op">+</span></span>
<span id="cb111-9"><a href="S-distribucion-muestreo.html#cb111-9"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></span>
<span id="cb111-10"><a href="S-distribucion-muestreo.html#cb111-10"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-14-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="S-distribucion-muestreo.html#cb112-1"></a><span class="co"># simular para el máximo</span></span>
<span id="cb112-2"><a href="S-distribucion-muestreo.html#cb112-2"></a>cuantil_<span class="dv">75</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">quantile</span>(x, <span class="fl">0.75</span>)</span>
<span id="cb112-3"><a href="S-distribucion-muestreo.html#cb112-3"></a>sim_estimador_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">replicar_muestreo_unif</span>(cuantil_<span class="dv">75</span>, <span class="dv">4000</span>, <span class="dv">15</span>)</span>
<span id="cb112-4"><a href="S-distribucion-muestreo.html#cb112-4"></a><span class="co"># graficar distribución de muestreo</span></span>
<span id="cb112-5"><a href="S-distribucion-muestreo.html#cb112-5"></a><span class="kw">ggplot</span>(sim_estimador_<span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">x =</span> estimacion)) <span class="op">+</span></span>
<span id="cb112-6"><a href="S-distribucion-muestreo.html#cb112-6"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.02</span>)) <span class="op">+</span></span>
<span id="cb112-7"><a href="S-distribucion-muestreo.html#cb112-7"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-15-1.png" width="480" style="display: block; margin: auto;" /></p>

<div class="ejercicio">
<p>Supón que tenemos una muestra de 30 observaciones de una distribución
uniforme <span class="math inline">\([0,b]\)</span>.</p>
<ul>
<li>¿Qué tan buen estimador de <span class="math inline">\(b/2\)</span> es la media muestral? ¿Cómo lo cuantificarías?</li>
<li>¿Qué tan buen estimador del cuantil 0.8 de la distribución uniforme es
el cuantil 0.8 muestral? ¿Qué desventajas notas en este estimador?</li>
</ul>
</div>

</div>
<div id="el-error-estándar" class="section level2 unnumbered">
<h2>El error estándar</h2>
<p>Una primera medida útil de la dispersión de la distribución de muestreo
es su desviación estándar: la razón específica tiene qué ver
con un resultado importante, el teorema central del límite, que veremos
más adelante. En este caso particular, a esta desviación estándar
se le llama error estándar:</p>
<div class="mathblock">
<p>
<strong>Definición</strong> A la desviación estándar de una estadística <span class="math inline"><span class="math inline">\(T\)</span></span> le llamamos su <strong>error estándar</strong>, y la denotamos por <span class="math inline"><span class="math inline">\(\text{ee}(T)\)</span></span>. A cualquier estimador de este error estándar lo denotamos como <span class="math inline"><span class="math inline">\(\hat{\text{ee}}(T)\)</span></span>.
</p>
</div>
<p>Este error estándar mide qué tanto varía el estimador <span class="math inline">\(T\)</span> de muestra a muestra.</p>
<p><strong>Observación</strong>: es importante no confundir el error estándar con
la desviación estándar de una muestra (o de la población).</p>
<p>En nuestro ejemplo
de las uniformes, la desviación estándar de las muestras varía como:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="S-distribucion-muestreo.html#cb113-1"></a><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>, <span class="op">~</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">runif</span>(<span class="dv">15</span>))) <span class="op">%&gt;%</span><span class="st"> </span>quantile <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##   0%  25%  50%  75% 100% 
## 0.11 0.26 0.29 0.31 0.41</code></pre>
<p>Mientras que el error estándar de la media es aproximadamente</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="S-distribucion-muestreo.html#cb115-1"></a><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>, <span class="op">~</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">runif</span>(<span class="dv">15</span>))) <span class="op">%&gt;%</span><span class="st"> </span>sd</span></code></pre></div>
<pre><code>## [1] 0.07439575</code></pre>
<p>y el error estándar del máximo es aproximadamente</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="S-distribucion-muestreo.html#cb117-1"></a><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>, <span class="op">~</span><span class="st"> </span><span class="kw">max</span>(<span class="kw">runif</span>(<span class="dv">15</span>))) <span class="op">%&gt;%</span><span class="st"> </span>sd</span></code></pre></div>
<pre><code>## [1] 0.05928675</code></pre>

<div class="ejercicio">
Como ejercicio para contrastar estos conceptos,
puedes considerar: ¿Qué pasa con la desviación estándar de una muestra muy
grande de uniformes? ¿Qué pasa con el error estándar de la media muestral de una muestra muy grande de uniformes?
</div>

<div id="ejemplo-valor-de-casas" class="section level3 unnumbered">
<h3>Ejemplo: valor de casas</h3>
<p>Consideramos el error estándar del estimador del total del inventario vendido, usando
una muestra de 250 con el estimador del total que consideramos. Como aproximamos con
simulación la distribución de muestreo, podemos hacer:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="S-distribucion-muestreo.html#cb119-1"></a>ee_<span class="dv">2</span> &lt;-<span class="st"> </span>replicaciones_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(est_total_millones) <span class="op">%&gt;%</span><span class="st"> </span>sd</span>
<span id="cb119-2"><a href="S-distribucion-muestreo.html#cb119-2"></a><span class="kw">round</span>(ee_<span class="dv">2</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 5.2</code></pre>
<p>que está en millones de pesos y cuantifica la dispersión de la distribución de
muestreo del estimador del total.</p>
<p>Para tamaño de muestra 100, obtenemos más dispersión:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="S-distribucion-muestreo.html#cb121-1"></a>ee_<span class="dv">1</span> &lt;-<span class="st"> </span>replicaciones_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(est_total_millones) <span class="op">%&gt;%</span><span class="st"> </span>sd</span>
<span id="cb121-2"><a href="S-distribucion-muestreo.html#cb121-2"></a><span class="kw">round</span>(ee_<span class="dv">1</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 8.9</code></pre>
<p>Nótese que esto es muy diferente, por ejemplo, a la desviación estándar
poblacional o de una muestra. Estas dos cantidades miden la variabilidad del
estimador del total.</p>
</div>
</div>
<div id="calculando-la-distribución-de-muestreo" class="section level2 unnumbered">
<h2>Calculando la distribución de muestreo</h2>
<p>En los ejemplos anteriores usamos simulación para obtener aproximaciones
de la distribución de muestreo de algunos estimadores. También
es posible:</p>
<ul>
<li>Hacer cálculos exactos a partir de modelos
probabilísticos.</li>
<li>Hacer aproximaciones asintóticas para muestras grandes (de las cuales
la más importante es la que da el teorema central del límite).</li>
</ul>
<p>En los ejemplos de arriba, cuando muestreamos de la poblaciones,
extrajimos las muestras de manera aproximadamente independiente. Cada
observación <span class="math inline">\(X_i\)</span> tiene la misma distribución y las <span class="math inline">\(X_i\)</span>’s son
independientes. Este tipo de diseños aleatorizados es de los más
simples, y se llama <strong>muestreo aleatorio simple</strong>.</p>
<p>En general, en esta parte haremos siempre este supuesto: Una <strong>muestra</strong>
es iid (independiente e idénticamente distribuida) si es
es un conjunto de observaciones <span class="math inline">\(X_1,X_2, \ldots X_n\)</span> independientes,
y cada una con la misma distribución.</p>
<p>En términos de poblaciones, esto lo logramos obteniendo cada observación
de manera aleatoria con el mismo procedimiento. En términos de modelos
probabilísticos, cada <span class="math inline">\(X_i\)</span> se extrae de la misma distribución fija <span class="math inline">\(F\)</span>
(que pensamos como la “población”) de manera independiente. Esto lo denotamos
por <span class="math inline">\(X_i \overset{iid}{\sim} F.\)</span></p>
<div id="ejemplo" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Si <span class="math inline">\(X_1, X_2, \ldots X_n\)</span> es una muestra de uniformes independientes en <span class="math inline">\([0,1]\)</span>, ¿cómo
calcularíamos la distribución de muestreo del máximo muestra <span class="math inline">\(T_2 = \max\)</span>? En este
caso, es fácil calcular su función de distribución acumulada de manera exacta:</p>
<p><span class="math display">\[F_{\max}(x) = P(\max\{X_1,X_2,\ldots X_n\} \leq x)\]</span>
El máximo es menor o igual a <span class="math inline">\(x\)</span> si y sólo si todas las <span class="math inline">\(X_i\)</span> son menores
o iguales a <span class="math inline">\(x\)</span>, así que
<span class="math display">\[F_{\max} (x) = P(X_1\leq x, X_2\leq x, \cdots, X_n\leq x)\]</span>
como las <span class="math inline">\(X_i\)</span>’s son independientes entonces
<span class="math display">\[F_{\max}(x) = P(X_1\leq x)P(X_2\leq x)\cdots P(X_n\leq x) = x^n\]</span>
para <span class="math inline">\(x\in [0,1]\)</span>, pues para cada <span class="math inline">\(X_i\)</span> tenemos <span class="math inline">\(P(X_i\leq x) = x\)</span> (demuéstralo).
Así que no es necesario usar simulación para conocer esta distribución de muestreo.
Derivando esta distribución acumulada obtenemos su densidad, que es</p>
<p><span class="math display">\[f(x) = nx^{n-1}\]</span></p>
<p>para <span class="math inline">\(x\in [0,1]\)</span>, y es cero en otro caso.</p>
<p>Si comparamos con nuestra simulación:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="S-distribucion-muestreo.html#cb123-1"></a>teorica &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span> ,<span class="fl">0.001</span>)) <span class="op">%&gt;%</span></span>
<span id="cb123-2"><a href="S-distribucion-muestreo.html#cb123-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">f_dens =</span> <span class="dv">15</span> <span class="op">*</span><span class="st"> </span>x<span class="op">^</span><span class="dv">14</span>)</span>
<span id="cb123-3"><a href="S-distribucion-muestreo.html#cb123-3"></a>sim_estimador_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">replicar_muestreo_unif</span>(max, <span class="dv">4000</span>, <span class="dv">15</span>)</span>
<span id="cb123-4"><a href="S-distribucion-muestreo.html#cb123-4"></a><span class="kw">ggplot</span>(sim_estimador_<span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb123-5"><a href="S-distribucion-muestreo.html#cb123-5"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> estimacion), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.02</span>)) <span class="op">+</span></span>
<span id="cb123-6"><a href="S-distribucion-muestreo.html#cb123-6"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb123-7"><a href="S-distribucion-muestreo.html#cb123-7"></a><span class="st">  </span><span class="co"># el histograma es de ancho 0.02 y el número de simulaciones 4000  </span></span>
<span id="cb123-8"><a href="S-distribucion-muestreo.html#cb123-8"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> teorica, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> (<span class="dv">4000</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.02</span>) <span class="op">*</span><span class="st"> </span>f_dens),</span>
<span id="cb123-9"><a href="S-distribucion-muestreo.html#cb123-9"></a>            <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-24-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Y vemos que con la simulación obtuvimos una buena aproximación</p>
<p><strong>Nota</strong>: ¿cómo se relaciona un histograma con la función de densidad
que genera los datos? Supón que <span class="math inline">\(f(x)\)</span> es una función de densidad, y
obtenemos un número <span class="math inline">\(n\)</span> de simulaciones independientes. Si escogemos
un histograma de ancho <span class="math inline">\(\Delta\)</span>, ¿cuántas observaciones esperamos
que caigan en un intervalo <span class="math inline">\(I = [a - \Delta/2, a + \Delta/2]\)</span>?. La probabilidad
de que una observación caiga en <span class="math inline">\(I\)</span> es igual a</p>
<p><span class="math display">\[P(X\in I) = \int_I f(x)\,dx = \int_{a - \Delta/2}^{a + \Delta/2} f(x)\,dx \approx f(a) \text{long}(I) = f(a) \Delta\]</span>
para <span class="math inline">\(\Delta\)</span> chica. Si nuestra muestra es de tamaño <span class="math inline">\(n\)</span>, el número esperado
de observaciones que caen en <span class="math inline">\(I\)</span> es entonces <span class="math inline">\(nf(a)\Delta\)</span>. Eso explica
el ajuste que hicimos en la gráfica de arriba. Otra manera de hacer es
ajustando el histograma: si en un intervalo el histograma alcanza el valor <span class="math inline">\(y\)</span>,
<span class="math display">\[f(a) = \frac{y}{n\Delta}\]</span></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="S-distribucion-muestreo.html#cb124-1"></a>teorica &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span> ,<span class="fl">0.001</span>)) <span class="op">%&gt;%</span></span>
<span id="cb124-2"><a href="S-distribucion-muestreo.html#cb124-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">f_dens =</span> <span class="dv">15</span><span class="op">*</span>x<span class="op">^</span>{<span class="dv">14</span>})</span>
<span id="cb124-3"><a href="S-distribucion-muestreo.html#cb124-3"></a><span class="kw">ggplot</span>(sim_estimador_<span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb124-4"><a href="S-distribucion-muestreo.html#cb124-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> estimacion, <span class="dt">y =</span> ..density..), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.02</span>)) <span class="op">+</span></span>
<span id="cb124-5"><a href="S-distribucion-muestreo.html#cb124-5"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb124-6"><a href="S-distribucion-muestreo.html#cb124-6"></a><span class="st">  </span><span class="co"># el histograma es de ancho 0.02 y el número de simulaciones 4000  </span></span>
<span id="cb124-7"><a href="S-distribucion-muestreo.html#cb124-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> teorica, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> f_dens),</span>
<span id="cb124-8"><a href="S-distribucion-muestreo.html#cb124-8"></a>            <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-25-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="ejemplo-1" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Supongamos que las <span class="math inline">\(X_i\)</span>’s son independientes y exponenciales con tasa <span class="math inline">\(\lambda &gt; 0\)</span>.
¿Cuál es la distribución de muestreo de la suma <span class="math inline">\(S = X_1 + \cdots + X_n\)</span>? Sabemos que la suma
de exponenciales independientes es una distribución gamma con parámetros <span class="math inline">\((n, \lambda)\)</span>,
y esta es la distribución de muestreo de nuestra estadística <span class="math inline">\(S\)</span> bajo las hipótesis
que hicimos.</p>
<p>Podemos checar este resultado con simulación, por ejemplo para una
muestra de tamaño <span class="math inline">\(n=15\)</span> con <span class="math inline">\(\lambda = 1\)</span>:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="S-distribucion-muestreo.html#cb125-1"></a>replicar_muestreo_exp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">est =</span> estimador_<span class="dv">1</span>, m, <span class="dt">n =</span> <span class="dv">15</span>, <span class="dt">lambda =</span> <span class="dv">1</span>){</span>
<span id="cb125-2"><a href="S-distribucion-muestreo.html#cb125-2"></a>  valores_est &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span>m, <span class="op">~</span><span class="st"> </span><span class="kw">est</span>(<span class="kw">rexp</span>(n, lambda)))</span>
<span id="cb125-3"><a href="S-distribucion-muestreo.html#cb125-3"></a>  <span class="kw">tibble</span>(<span class="dt">id_muestra =</span> <span class="dv">1</span><span class="op">:</span>m, <span class="dt">estimacion =</span> valores_est)</span>
<span id="cb125-4"><a href="S-distribucion-muestreo.html#cb125-4"></a>}</span>
<span id="cb125-5"><a href="S-distribucion-muestreo.html#cb125-5"></a>sim_estimador_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">replicar_muestreo_exp</span>(sum, <span class="dv">4000</span>, <span class="dt">n =</span> <span class="dv">15</span>)</span>
<span id="cb125-6"><a href="S-distribucion-muestreo.html#cb125-6"></a>teorica &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">35</span>, <span class="fl">0.001</span>)) <span class="op">%&gt;%</span></span>
<span id="cb125-7"><a href="S-distribucion-muestreo.html#cb125-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">f_dens =</span> <span class="kw">dgamma</span>(x, <span class="dt">shape =</span> <span class="dv">15</span>, <span class="dt">rate =</span> <span class="dv">1</span>))</span>
<span id="cb125-8"><a href="S-distribucion-muestreo.html#cb125-8"></a><span class="co"># graficar aprox de distribución de muestreo</span></span>
<span id="cb125-9"><a href="S-distribucion-muestreo.html#cb125-9"></a><span class="kw">ggplot</span>(sim_estimador_<span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb125-10"><a href="S-distribucion-muestreo.html#cb125-10"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> estimacion, <span class="dt">y =</span> ..density..), <span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></span>
<span id="cb125-11"><a href="S-distribucion-muestreo.html#cb125-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> teorica, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> f_dens), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-26-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="teorema-central-del-límite" class="section level2 unnumbered">
<h2>Teorema central del límite</h2>
<p>Si consideramos los ejemplos de arriba donde tratamos con estimadores
basados en una suma, total o una media —y en menor medida cuantiles muestrales—,
vimos que las distribución de
muestreo de las estadísticas que usamos tienden a tener una forma común.
Estas son manifestaciones de una regularidad estadística importante que
se conoce como el <strong>teorema central del límite</strong>: las distribuciones de muestreo
de sumas y promedios son aproximadamente normales cuando el tamaño de muestra
es suficientemente grande.</p>

<div class="mathblock">
<p><strong>Teorema central del límite</strong></p>
<p>Si <span class="math inline">\(X_1,X_2, \ldots, X_n\)</span> son independientes e idénticamente distribuidas con
media <span class="math inline">\(\mu\)</span> y desviación estándar <span class="math inline">\(\sigma\)</span> finitas.</p>
<p>Si el tamaño de muestra <span class="math inline">\(n\)</span> es grande, entonces la distribución de muestreo de la media</p>
<p><span class="math display">\[\bar{X} = \frac{X_1 + X_2 +\cdots + X_n}{n}\]</span></p>
<p>es aproximadamente normal con media <span class="math inline">\(\mu\)</span> y desviación estándar <span class="math inline">\(\sigma/\sqrt{n}\)</span>,
que escribimos como</p>
<p><span class="math display">\[\bar{X} \xrightarrow{} \mathsf{N}\left( \mu, \frac{\sigma}{\sqrt{n}} \right)\]</span></p>
<p>Adicionalmente, la distribución de la
media estandarizada converge a una distribución normal
estándar cuando <span class="math inline">\(n\)</span> es grande:
<span class="math display">\[\sqrt{n} \, \left( \frac{\bar{X}-\mu}{\sigma} \right) \xrightarrow{}  \mathsf{N}(0, 1)\]</span></p>
</div>

<ul>
<li><p>El error estándar de <span class="math inline">\(\bar{X}\)</span> es
<span class="math inline">\(\text{ee}(\bar{X}) = \frac{\sigma}{\sqrt{n}}\)</span>. Si tenemos una muestra, podemos
estimar <span class="math inline">\(\sigma\)</span> con de la siguiente forma:
<span class="math display">\[\hat{\sigma} =\sqrt{\frac{1}{n}\sum_{i=1}^n (X_i - \bar{X})^2}\]</span>
o el más común (que explicaremos más adelante)
<span class="math display">\[\hat{s} = \sqrt{\frac{1}{n-1}\sum_{i=1}^n (X_i - \bar{X})^2}\]</span></p></li>
<li><p>Este hecho junto con el teorema del límite central nos dice cuál es la dispersión,
y cómo se distribuyen las posibles desviaciones de la media muestral alrededor
de la verdadera media poblacional.</p></li>
<li><p>¿Qué tan grande debe ser <span class="math inline">\(n\)</span>. Depende de cómo es la población. Cuando la población
tiene una distribución muy sesgada, por ejemplo, <span class="math inline">\(n\)</span> típicamente
necesita ser más grande que cuando la población es simétrica si queremos
obtener una aproximación “buena”.</p></li>
<li><p>En algunos textos se afirma que <span class="math inline">\(n\geq 30\)</span> es suficiente para que la
aproximación del Teorema central del límite (TCL) sea buena siempre y cuando
la distribución poblacional no sea muy sesgada. Esta regla es más o menos arbitraria
y es mejor no confiarse, pues fácilmente puede fallar. En la práctica es importante
checar este supuesto, por ejemplo usando remuestreo (que veremos más adelante)</p></li>
</ul>
<div class="ejercicio">
<p>
Revisa los ejemplos que hemos visto hasta ahora (precios de casas, simulaciones de uniformes y exponenciales según las distintas estadísticas que consideramos). ¿Qué distribuciones de muestreo parecen tener una distribución normal? ¿Cómo juzgamos si estas distribuciones están cerca o lejos de una distribución normal?
</p>
</div>
</div>
<div id="normalidad-y-gráficas-de-cuantiles-normales" class="section level2 unnumbered">
<h2>Normalidad y gráficas de cuantiles normales</h2>
<p>Para checar si una distribución de datos dada es similar a la normal, la herramienta
mas común en estádística es la gráfica de cuantiles teóricos, que es una generalización
de la gráfica de cuantiles que vimos anteriormente.</p>
<p>En primer lugar, definimos la función de cuantiles de una distribución teórica,
que es análoga a la que definimos para conjuntos de datos:</p>
<p>Supongamos que tenemos una distribución acumulada teórica <span class="math inline">\(\Phi\)</span>. Podemos
definir el cuantil-<span class="math inline">\(f\)</span> <span class="math inline">\(q(f)\)</span> de <span class="math inline">\(\Phi\)</span> como
el valor <span class="math inline">\(q(f)\)</span> tal que
<span class="math display">\[q(f) = \text{argmin}\{x \,| \, \Phi(x)\geq f \}\]</span></p>
<p>En el caso de que <span class="math inline">\(\Phi\)</span> tiene densidad <span class="math inline">\(\phi\)</span>, y su soporte es un intervalo (que puede
ser de longitud infinita), entonces podemos también escribir <span class="math inline">\(q(f)\)</span>
como el valor único donde acumulamos <span class="math inline">\(f\)</span> de la probabilidad</p>
<p><span class="math display">\[\int_{-\infty}^{q(f)} \phi(x)\,dx= f\]</span>
Por ejemplo, para una densidad normal, abajo mostramos los cuantiles <span class="math inline">\(f=0.5\)</span> (mediana)
y <span class="math inline">\(f=0.95\)</span></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="S-distribucion-muestreo.html#cb126-1"></a>densidad_tbl &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb126-2"><a href="S-distribucion-muestreo.html#cb126-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">densidad =</span> <span class="kw">dnorm</span>(x, <span class="dv">5</span>, <span class="dv">1</span>)) </span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="S-distribucion-muestreo.html#cb127-1"></a><span class="co"># qnorm es la función de cuantiles de una normal</span></span>
<span id="cb127-2"><a href="S-distribucion-muestreo.html#cb127-2"></a>cuantil_<span class="dv">50</span> &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.50</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb127-3"><a href="S-distribucion-muestreo.html#cb127-3"></a>cuantil_<span class="dv">90</span> &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb127-4"><a href="S-distribucion-muestreo.html#cb127-4"></a><span class="co"># graficamos</span></span>
<span id="cb127-5"><a href="S-distribucion-muestreo.html#cb127-5"></a>densidad_tbl &lt;-<span class="st"> </span>densidad_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb127-6"><a href="S-distribucion-muestreo.html#cb127-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">menor_50 =</span> x <span class="op">&gt;=</span><span class="st"> </span>cuantil_<span class="dv">50</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb127-7"><a href="S-distribucion-muestreo.html#cb127-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">menor_90 =</span> x <span class="op">&gt;=</span><span class="st"> </span>cuantil_<span class="dv">90</span>)</span>
<span id="cb127-8"><a href="S-distribucion-muestreo.html#cb127-8"></a>g_normal_<span class="dv">50</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(densidad_tbl, <span class="kw">aes</span>(<span class="dt">y =</span> densidad)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb127-9"><a href="S-distribucion-muestreo.html#cb127-9"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;f(x)&#39;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb127-10"><a href="S-distribucion-muestreo.html#cb127-10"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">fill =</span> menor_<span class="dv">50</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb127-11"><a href="S-distribucion-muestreo.html#cb127-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x), <span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb127-12"><a href="S-distribucion-muestreo.html#cb127-12"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> cuantil_<span class="dv">50</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb127-13"><a href="S-distribucion-muestreo.html#cb127-13"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="fl">4.3</span>, <span class="fl">0.2</span>, <span class="dt">label =</span> <span class="st">&quot;50%&quot;</span>) <span class="op">+</span></span>
<span id="cb127-14"><a href="S-distribucion-muestreo.html#cb127-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&quot;q(0.5)=&quot;</span>, <span class="kw">round</span>(cuantil_<span class="dv">50</span>,<span class="dv">1</span>)))</span>
<span id="cb127-15"><a href="S-distribucion-muestreo.html#cb127-15"></a>g_normal_<span class="dv">90</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(densidad_tbl, <span class="kw">aes</span>(<span class="dt">y =</span> densidad)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb127-16"><a href="S-distribucion-muestreo.html#cb127-16"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;f(x)&#39;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb127-17"><a href="S-distribucion-muestreo.html#cb127-17"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">fill =</span> menor_<span class="dv">90</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb127-18"><a href="S-distribucion-muestreo.html#cb127-18"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x), <span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb127-19"><a href="S-distribucion-muestreo.html#cb127-19"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> cuantil_<span class="dv">90</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb127-20"><a href="S-distribucion-muestreo.html#cb127-20"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="fl">5.0</span>, <span class="fl">0.2</span>, <span class="dt">label =</span> <span class="st">&quot;95%&quot;</span>) <span class="op">+</span></span>
<span id="cb127-21"><a href="S-distribucion-muestreo.html#cb127-21"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&quot;q(0.95)=&quot;</span>, <span class="kw">round</span>(cuantil_<span class="dv">90</span>,<span class="dv">1</span>)))</span>
<span id="cb127-22"><a href="S-distribucion-muestreo.html#cb127-22"></a>g_normal_<span class="dv">50</span> <span class="op">+</span><span class="st"> </span>g_normal_<span class="dv">90</span></span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Como todas las distribuciones normales tienen la misma forma, y para obtener una de otra
solo basta reescalar y desplazar, para calcular los cuantiles de una
variable con distribución normal <span class="math inline">\(\mathsf{N}(\mu, \sigma)\)</span>
sólo tenemos que saber los cuantiles de la distribución normal estándar <span class="math inline">\(\mathsf{N}(0,1)\)</span> y escalarlos
apropiadamente por su media y desviación estándar</p>
<p><span class="math display">\[q(f, \mu, \sigma) = \mu + \sigma q(f, 0, 1)\]</span>
Puedes demostrar esto sin mucha dificultad empezando con <span class="math inline">\(P(X\leq q) = f\)</span> y estandarizando:</p>
<p><span class="math display">\[P(X\leq q(f, \mu, \sigma)) = f \implies P\left (Z\leq \frac{q(f,\mu,\sigma) - \mu}{\sigma}\right)=f\]</span>
y esto implica que
<span class="math display">\[q(f, 0, 1) =  \frac{q(f,\mu,\sigma) - \mu}{\sigma} \implies q(f, \mu, \sigma) = \mu + \sigma q(f, 0, 1)\]</span></p>
<p>De modo que si graficáramos los cuantiles de una distribución <span class="math inline">\(\mathsf{N}(\mu, \sigma)\)</span> contra
los cuantiles de una distribución <span class="math inline">\(\mathsf{N}(0,1)\)</span>, estos cuantiles aparecen en una línea recta:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="S-distribucion-muestreo.html#cb128-1"></a>comparacion_tbl &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">f =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb128-2"><a href="S-distribucion-muestreo.html#cb128-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cuantiles_normal =</span> <span class="kw">qnorm</span>(f, <span class="dv">5</span>, <span class="dv">3</span>),</span>
<span id="cb128-3"><a href="S-distribucion-muestreo.html#cb128-3"></a>         <span class="dt">cuantiles_norm_estandar =</span> <span class="kw">qnorm</span>(f, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb128-4"><a href="S-distribucion-muestreo.html#cb128-4"></a><span class="kw">ggplot</span>(comparacion_tbl, <span class="kw">aes</span>(cuantiles_norm_estandar, cuantiles_normal)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb128-5"><a href="S-distribucion-muestreo.html#cb128-5"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-31-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Ahora supongamos que tenemos una muestra <span class="math inline">\(X_1, \ldots, X_n\)</span>. ¿Cómo podemos
checar si estos datos tienen una distribución aproximadamente normal?</p>
<ul>
<li>Si la muestra tiene una distribución aproximadamente <span class="math inline">\(\mathsf{N}(\mu, \sigma)\)</span>, entonces
sus cuantiles muestrales y los cuantiles respectivos de la normal estándar están aproximadamente
en una línea recta.</li>
</ul>
<p>Primero veamos un ejemplo donde los datos son generados según una normal.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="S-distribucion-muestreo.html#cb129-1"></a><span class="kw">set.seed</span>(<span class="dv">21</span>)</span>
<span id="cb129-2"><a href="S-distribucion-muestreo.html#cb129-2"></a>muestra &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x_1 =</span> <span class="kw">rnorm</span>(<span class="dv">60</span>, <span class="dv">10</span>, <span class="dv">3</span>), <span class="dt">x_2 =</span> <span class="kw">rgamma</span>(<span class="dv">60</span>, <span class="dv">2</span>, <span class="dv">5</span>))</span>
<span id="cb129-3"><a href="S-distribucion-muestreo.html#cb129-3"></a>graf_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(muestra, <span class="kw">aes</span>(<span class="dt">sample =</span> x_<span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb129-4"><a href="S-distribucion-muestreo.html#cb129-4"></a><span class="st">  </span><span class="kw">geom_qq</span>(<span class="dt">distribution =</span> stats<span class="op">::</span>qnorm) <span class="op">+</span></span>
<span id="cb129-5"><a href="S-distribucion-muestreo.html#cb129-5"></a><span class="st">  </span><span class="kw">geom_qq_line</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb129-6"><a href="S-distribucion-muestreo.html#cb129-6"></a>graf_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(muestra, <span class="kw">aes</span>(<span class="dt">sample =</span> x_<span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb129-7"><a href="S-distribucion-muestreo.html#cb129-7"></a><span class="st">  </span><span class="kw">geom_qq</span>(<span class="dt">distribution =</span> stats<span class="op">::</span>qnorm) <span class="op">+</span></span>
<span id="cb129-8"><a href="S-distribucion-muestreo.html#cb129-8"></a><span class="st">  </span><span class="kw">geom_qq_line</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb129-9"><a href="S-distribucion-muestreo.html#cb129-9"></a>graf_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>graf_<span class="dv">2</span></span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" />
¿Cuáles son los datos aproximadamente normales? ¿Cómo interpretas las desviaciones de
la segunda gráfica en términos de la forma de la distribución normal?</p>
</div>
<div id="prueba-de-hipótesis-de-normalidad" class="section level2 unnumbered">
<h2>Prueba de hipótesis de normalidad</h2>
<p>Para interpretar las gráficas de cuantiles normales se requiere práctica,
pues claramente los datos, aún cuando provengan de una distribución normal, no
van a caer justo sobre una línea recta y observaremos variabilidad. Esto no descarta
neceariamente que los datos sean aproximadamente normales. Con la práctica, generalmente
esta gráfica nos da una buena indicación si el supuesto de normalidad es apropiado.</p>
<p>Sin embargo, podemos hacer una prueba de hipótesis formal de normalidad si
quisiéramos. La hipótesis nula es la siguiente:</p>
<ul>
<li>Los datos provienen de una distribución normal, y las desviaciones que observamos
de una línea recta se deben a variación muestral.</li>
<li>Podemos generar datos nulos tomando la media y desviación estándar muestrales, y
generando muestras normales <span class="math inline">\(\mathsf{N}(\bar{x}, s)\)</span>.</li>
<li>Usamos el <em>lineup</em>, produciendo datos bajo la hipótesis nula y viendo si
podemos distinguir los datos. Por ejemplo:</li>
</ul>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="S-distribucion-muestreo.html#cb130-1"></a><span class="kw">library</span>(nullabor)</span>
<span id="cb130-2"><a href="S-distribucion-muestreo.html#cb130-2"></a>lineup_normal &lt;-<span class="st"> </span><span class="kw">lineup</span>(<span class="kw">null_dist</span>(<span class="st">&quot;x_2&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>), muestra)</span>
<span id="cb130-3"><a href="S-distribucion-muestreo.html#cb130-3"></a><span class="kw">ggplot</span>(lineup_normal, <span class="kw">aes</span>(<span class="dt">sample =</span> x_<span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb130-4"><a href="S-distribucion-muestreo.html#cb130-4"></a><span class="st">  </span><span class="kw">geom_qq</span>(<span class="dt">distribution =</span> stats<span class="op">::</span>qnorm) <span class="op">+</span></span>
<span id="cb130-5"><a href="S-distribucion-muestreo.html#cb130-5"></a><span class="st">  </span><span class="kw">geom_qq_line</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb130-6"><a href="S-distribucion-muestreo.html#cb130-6"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>.sample)</span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>En esta gráfica claramente rechazaríamos la hipótesis de normalidad. Sin embargo, para
la primera muestra, obtenemos:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="S-distribucion-muestreo.html#cb131-1"></a>lineup_normal &lt;-<span class="st"> </span><span class="kw">lineup</span>(<span class="kw">null_dist</span>(<span class="st">&quot;x_1&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>), muestra)</span>
<span id="cb131-2"><a href="S-distribucion-muestreo.html#cb131-2"></a><span class="kw">ggplot</span>(lineup_normal, <span class="kw">aes</span>(<span class="dt">sample =</span> x_<span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb131-3"><a href="S-distribucion-muestreo.html#cb131-3"></a><span class="st">  </span><span class="kw">geom_qq</span>(<span class="dt">distribution =</span> stats<span class="op">::</span>qnorm) <span class="op">+</span></span>
<span id="cb131-4"><a href="S-distribucion-muestreo.html#cb131-4"></a><span class="st">  </span><span class="kw">geom_qq_line</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb131-5"><a href="S-distribucion-muestreo.html#cb131-5"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>.sample)</span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-34-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Los datos verdaderos están en</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="S-distribucion-muestreo.html#cb132-1"></a><span class="kw">attr</span>(lineup_normal, <span class="st">&quot;pos&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div id="ejemplo-2" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Consideremos el problema de estimar el total poblacional de los precios de las casas
que se vendieron. El estimador que usamos fue la suma muestral expandida por un
factor. Vamos a checar qué tan cerca de la normalidad está la distribución de
meustreo de esta estadística (<span class="math inline">\(n=250\)</span>):</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="S-distribucion-muestreo.html#cb134-1"></a>replicaciones_<span class="dv">2</span></span></code></pre></div>
<pre><code>## # A tibble: 1,500 x 4
##    id_muestra total_muestra factor_exp est_total_millones
##    &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt;              &lt;dbl&gt;
##  1 1                 47089.       4.58               215.
##  2 2                 45654.       4.58               209.
##  3 3                 43973.       4.58               201.
##  4 4                 45665.       4.58               209.
##  5 5                 43551.       4.58               199.
##  6 6                 46066.       4.58               211.
##  7 7                 46626.       4.58               213.
##  8 8                 47944.       4.58               219.
##  9 9                 45381.       4.58               208.
## 10 10                46519.       4.58               213.
## # … with 1,490 more rows</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="S-distribucion-muestreo.html#cb136-1"></a><span class="kw">ggplot</span>(replicaciones_<span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">sample =</span> est_total_millones)) <span class="op">+</span></span>
<span id="cb136-2"><a href="S-distribucion-muestreo.html#cb136-2"></a><span class="st">  </span><span class="kw">geom_qq</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_qq_line</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-37-1.png" width="384" style="display: block; margin: auto;" />
Y vemos que en efecto el TCL aplica en este ejemplo, y la aproximación es buena.
Aunque la población original es sesgada, la descripción de la distribución de
muestreo es sorprendemente compacta:</p>
<ul>
<li>La distribución de muestreo de nuestro estimador del total <span class="math inline">\(\hat{t}\)</span> es
aproximadamente normal con media <span class="math inline">\(\bar{x}\)</span> y desviación estándar <span class="math inline">\(s\)</span>, donde:</li>
</ul>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="S-distribucion-muestreo.html#cb137-1"></a>mu &lt;-<span class="st"> </span><span class="kw">mean</span>(replicaciones_<span class="dv">2</span><span class="op">$</span>est_total_millones)</span>
<span id="cb137-2"><a href="S-distribucion-muestreo.html#cb137-2"></a>s &lt;-<span class="st"> </span><span class="kw">sd</span>(replicaciones_<span class="dv">2</span><span class="op">$</span>est_total_millones)</span>
<span id="cb137-3"><a href="S-distribucion-muestreo.html#cb137-3"></a><span class="kw">c</span>(<span class="dt">mu =</span> mu, <span class="dt">s =</span> s) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##     mu      s 
## 209.90   5.24</code></pre>
<p>Estas cantidades están en millones de dólares.</p>
</div>
<div id="ejemplo-3" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Supongamos que queremos calcular la probabilidad que la suma de 30 variables
uniformes en <span class="math inline">\([0,1]\)</span> independientes sea mayor que 18. Podríamos aproximar esta
cantidad usando simulación. Otra manera de aproximar esta cantidad es con
el TCL, de la siguiente forma:</p>
<p>Si <span class="math inline">\(S=X_1 + X_2 + X_{30}\)</span>, entonces la media de <span class="math inline">\(S\)</span> es 15 (¿cómo se calcula’)
y su desviación estándar es <span class="math inline">\(\sqrt{\frac{30}{12}}\)</span>. La suma es entonces
aproximadamente <span class="math inline">\(\mathsf{N}\left(15, \sqrt{\frac{30}{12}}\right)\)</span>. Entonces</p>
<p><span class="math display">\[P(S &gt; 50) = P \left (\frac{S - 15}{\sqrt{\frac{30}{12}}}  &gt; \frac{18 - 15}{\sqrt{\frac{30}{12}}}\right) \approx P(Z &gt; 1.897)\]</span></p>
<p>donde <span class="math inline">\(Z\)</span> es normal estándar. Esta última cantidad la calculamos
usando la función de distribución de la normal estándar, y nuestra aproximación es</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="S-distribucion-muestreo.html#cb139-1"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="fl">1.897</span>)</span></code></pre></div>
<pre><code>## [1] 0.02891397</code></pre>
<p>Podemos checar nuestro cálculo usando simulación:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="S-distribucion-muestreo.html#cb141-1"></a><span class="kw">tibble</span>(<span class="dt">n_sim =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100000</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb141-2"><a href="S-distribucion-muestreo.html#cb141-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">suma =</span> <span class="kw">map_dbl</span>(n_sim, <span class="op">~</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">runif</span>(<span class="dv">30</span>)))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb141-3"><a href="S-distribucion-muestreo.html#cb141-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">prob_may_18 =</span> <span class="kw">mean</span>(suma <span class="op">&gt;</span><span class="st"> </span><span class="dv">18</span>), <span class="dt">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   prob_may_18
##         &lt;dbl&gt;
## 1      0.0280</code></pre>
<p>Y vemos que la aproximación normal es buena para fines prácticos.</p>
<div class="ejercicio">
<p>
Usando simulaciones haz un histograma que aproxime la distribución de muestreo de <span class="math inline"><span class="math inline">\(S\)</span></span>. Haz una gráfica de cuantiles normales para checar la normalidad de esta distribución.
</p>
</div>
</div>
</div>
<div id="ejemplo-4" class="section level2 unnumbered">
<h2>Ejemplo</h2>
<p>Cuando el sesgo de la distribución poblacional es grande, puede ser necesario
que <span class="math inline">\(n\)</span> sea muy grande para que la aproximación normal sea aceptable para el
promedio o la suma. Por ejemplo, si tomamos una gamma con parámetro de forma chico,
<span class="math inline">\(n = 30\)</span> no es suficientemente bueno, especialmente si quisiéramos
aproximar probabilidades en las colas de la distribución:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="S-distribucion-muestreo.html#cb143-1"></a>sims_gamma &lt;-<span class="st"> </span><span class="kw">map_df</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>, <span class="op">~</span><span class="st"> </span><span class="kw">tibble</span>(<span class="dt">suma =</span> <span class="kw">mean</span>(<span class="kw">rgamma</span>(<span class="dv">30</span>, <span class="fl">0.1</span>, <span class="dv">1</span>))), </span>
<span id="cb143-2"><a href="S-distribucion-muestreo.html#cb143-2"></a>                     <span class="dt">.id =</span> <span class="st">&quot;n_sim&quot;</span>)</span>
<span id="cb143-3"><a href="S-distribucion-muestreo.html#cb143-3"></a><span class="kw">ggplot</span>(sims_gamma, <span class="kw">aes</span>(<span class="dt">x =</span> suma)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="05-distribucion-muestreo_files/figure-html/unnamed-chunk-42-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="más-del-teorema-central-del-límite" class="section level2 unnumbered">
<h2>Más del Teorema central del límite</h2>
<ul>
<li><p>El teorema central del límite aplica a situaciones más generales que
las del enunciado del teorema básico. Por ejemplo, aplica a poblaciones
finitas (como vimos en el ejemplo de las casas) bajo muestreo sin
reemplazo, y aplica también a otras estadísticas como los cuantiles muestrales.</p></li>
<li><p>Es importante notar que la calidad de la aproximación del TCL depende de características
de la población y también del tamaño de muestra <span class="math inline">\(n\)</span>. Para ver si el TCL aplica, podemos hacer ejercicios de simulación bajo diferentes supuestos acerca de la población.
También veremos más adelante, con remuestreo, maneras de checar si es factible el TCL dependiendo del análisis de una muestra dada que tengamos.</p></li>
<li><p>El TCL era particularmente importante en la práctica antes de que pudiéramos
hacer simulación por computadora. Era la única manera de aproximar y entender la distribución muestral fuera de cálculos analíticos (como los que hicimos para
el máximo de un conjunto de uniformes, por ejemplo).</p></li>
<li><p>Hoy en día, veremos que podemos hacer simulación para obtener respuestas más
exactas, particularmente en la construcción de intervalos de confianza, por ejemplo. Dependemos menos de <strong>resultados asintóticos</strong>, como el TCL.</p></li>
<li><p>Cuando aproximamos una distribución discreta mediante la distribución normal,
conviene hacer <em>correcciones de continuidad</em>, como se explica en <span class="citation">(Chihara and Hesterberg <a href="#ref-Chihara" role="doc-biblioref">2018</a>)</span>, 4.3.2.</p></li>
</ul>

</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-Chihara">
<p>Chihara, Laura M., and Tim C. Hesterberg. 2018. <em>Mathematical Statistics with Resampling and R</em>. 2nd ed. Hoboken, NJ: John Wiley &amp; Sons. <a href="https://sites.google.com/site/chiharahesterberg/home">https://sites.google.com/site/chiharahesterberg/home</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pruebas-de-hipótesis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intervalos-de-confianza-y-remuestreo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/fundamentos/edit/master/05-distribucion-muestreo.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["fundamentos-estadistica.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

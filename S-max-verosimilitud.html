<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Sección 7 Estimación por máxima verosimilitud | EST-46111: Fundamentos de Estadística con Remuestreo</title>
  <meta name="description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2020." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Sección 7 Estimación por máxima verosimilitud | EST-46111: Fundamentos de Estadística con Remuestreo" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2020." />
  <meta name="github-repo" content="tereom/fundamentos" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Sección 7 Estimación por máxima verosimilitud | EST-46111: Fundamentos de Estadística con Remuestreo" />
  
  <meta name="twitter:description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2020." />
  

<meta name="author" content="Teresa Ortiz (001), Alfredo Garbuno (002), Felipe González" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intervalos-de-confianza-y-remuestreo.html"/>
<link rel="next" href="bootstrap-paramétrico.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Fundamentos de Estadística con Remuestreo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#temario"><i class="fa fa-check"></i>Temario</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#evaluación"><i class="fa fa-check"></i>Evaluación</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html"><i class="fa fa-check"></i><b>1</b> Principios de visualización</a><ul>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#el-cuarteto-de-ascombe"><i class="fa fa-check"></i>El cuarteto de Ascombe</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#introducción"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#teoría-de-visualización-de-datos"><i class="fa fa-check"></i>Teoría de visualización de datos</a><ul>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#principios-generales-del-diseño-analítico"><i class="fa fa-check"></i>Principios generales del diseño analítico</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#técnicas-de-visualización"><i class="fa fa-check"></i>Técnicas de visualización</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#indicadores-de-calidad-gráfica"><i class="fa fa-check"></i>Indicadores de calidad gráfica</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#factor-de-engaño-y-chartjunk"><i class="fa fa-check"></i>Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#pequeños-múltiplos-y-densidad-gráfica"><i class="fa fa-check"></i>Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#tinta-de-datos"><i class="fa fa-check"></i>Tinta de datos</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#decoración"><i class="fa fa-check"></i>Decoración</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#percepción-de-escala"><i class="fa fa-check"></i>Percepción de escala</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#ejemplo-gráfica-de-minard"><i class="fa fa-check"></i>Ejemplo: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html"><i class="fa fa-check"></i><b>2</b> Análisis exploratorio</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#el-papel-de-la-exploración-en-el-análisis-de-datos"><i class="fa fa-check"></i>El papel de la exploración en el análisis de datos</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#algunos-conceptos-básicos"><i class="fa fa-check"></i>Algunos conceptos básicos</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#media-y-desviación-estándar"><i class="fa fa-check"></i>Media y desviación estándar</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#ejemplos"><i class="fa fa-check"></i>Ejemplos</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#precios-de-casas"><i class="fa fa-check"></i>Precios de casas</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#prueba-enlace"><i class="fa fa-check"></i>Prueba Enlace</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#estados-y-calificaciones-en-sat"><i class="fa fa-check"></i>Estados y calificaciones en SAT</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#tablas-de-conteos"><i class="fa fa-check"></i>Tablas de conteos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#loess"><i class="fa fa-check"></i>Loess</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#ajustando-curvas-loess"><i class="fa fa-check"></i>Ajustando curvas loess</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#series-de-tiempo"><i class="fa fa-check"></i>Series de tiempo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html"><i class="fa fa-check"></i><b>3</b> Tipos de estudio y experimentos</a><ul>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#motivación"><i class="fa fa-check"></i>Motivación</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#proceso-generador-de-datos"><i class="fa fa-check"></i>Proceso Generador de Datos</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#ejemplo-prevalencia-de-anemia"><i class="fa fa-check"></i>Ejemplo: Prevalencia de anemia</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#muestreo-aleatorio"><i class="fa fa-check"></i>Muestreo aleatorio</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#pero-si-no-podemos-hacer-muestreo-aleatorio"><i class="fa fa-check"></i>Pero si no podemos hacer muestreo aleatorio?</a><ul>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#ejemplo-policías-y-tráfico"><i class="fa fa-check"></i>Ejemplo: Policías y tráfico</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#el-estimador-estándar"><i class="fa fa-check"></i>El estimador estándar</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#experimentos-tradicionales"><i class="fa fa-check"></i>Experimentos tradicionales</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#bloqueo"><i class="fa fa-check"></i>Bloqueo</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#variables-desconocidas"><i class="fa fa-check"></i>Variables desconocidas</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#aleatorizando-el-tratamiento"><i class="fa fa-check"></i>Aleatorizando el tratamiento</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#resumen-selección-de-unidades-y-tratamiento"><i class="fa fa-check"></i>Resumen: selección de unidades y tratamiento</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#asignación-natural-del-tratamiento"><i class="fa fa-check"></i>Asignación natural del tratamiento</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html"><i class="fa fa-check"></i><b>4</b> Pruebas de hipótesis</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#comparación-con-poblaciones-de-referencia"><i class="fa fa-check"></i>Comparación con poblaciones de referencia</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#comparando-distribuciones"><i class="fa fa-check"></i>Comparando distribuciones</a></li>
<li><a href="pruebas-de-hipótesis.html#prueba-de-permutaciones-y-el-lineup">Prueba de permutaciones y el <em>lineup</em></a></li>
<li><a href="pruebas-de-hipótesis.html#comparaciones-usando-lineup-continuación">Comparaciones usando <em>lineup</em> (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-permutaciones-para-proporciones"><i class="fa fa-check"></i>Prueba de permutaciones para proporciones</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#pruebas-de-hipótesis-tradicionales"><i class="fa fa-check"></i>Pruebas de hipótesis tradicionales</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#tomadores-de-té-continuación"><i class="fa fa-check"></i>Tomadores de té (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#pruebas-de-permutación-implementación"><i class="fa fa-check"></i>Pruebas de permutación: Implementación</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-tiempos-de-fusión"><i class="fa fa-check"></i>Ejemplo: tiempos de fusión</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-tiempos-de-fusión-continuación"><i class="fa fa-check"></i>Ejemplo: tiempos de fusión (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#separación-de-grupos"><i class="fa fa-check"></i>Separación de grupos</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#avispas-opcional"><i class="fa fa-check"></i>Avispas (opcional)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#la-crisis-de-replicabilidad"><i class="fa fa-check"></i>La “crisis de replicabilidad”</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#el-jardín-de-los-senderos-que-se-bifurcan"><i class="fa fa-check"></i>El jardín de los senderos que se bifurcan</a></li>
<li><a href="pruebas-de-hipótesis.html#ejemplo-decisiones-de-análisis-y-valores-p">Ejemplo: decisiones de análisis y valores <em>p</em></a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#alternativas-o-soluciones"><i class="fa fa-check"></i>Alternativas o soluciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html"><i class="fa fa-check"></i><b>5</b> Estimación y distribución de muestreo</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-precios-de-casas"><i class="fa fa-check"></i>Ejemplo: precios de casas</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#distribución-de-muestreo"><i class="fa fa-check"></i>Distribución de muestreo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#más-ejemplos"><i class="fa fa-check"></i>Más ejemplos</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#el-error-estándar"><i class="fa fa-check"></i>El error estándar</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-valor-de-casas"><i class="fa fa-check"></i>Ejemplo: valor de casas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#calculando-la-distribución-de-muestreo"><i class="fa fa-check"></i>Calculando la distribución de muestreo</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#teorema-central-del-límite"><i class="fa fa-check"></i>Teorema central del límite</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#normalidad-y-gráficas-de-cuantiles-normales"><i class="fa fa-check"></i>Normalidad y gráficas de cuantiles normales</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#prueba-de-hipótesis-de-normalidad"><i class="fa fa-check"></i>Prueba de hipótesis de normalidad</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#más-del-teorema-central-del-límite"><i class="fa fa-check"></i>Más del Teorema central del límite</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html"><i class="fa fa-check"></i><b>6</b> Intervalos de confianza y remuestreo</a><ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-introductorio"><i class="fa fa-check"></i>Ejemplo introductorio</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#la-idea-del-bootstrap"><i class="fa fa-check"></i>La idea del bootstrap</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#el-principio-de-plug-in"><i class="fa fa-check"></i>El principio de plug-in</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#discusión-propiedades-de-la-distribución-bootstrap"><i class="fa fa-check"></i>Discusión: propiedades de la distribución bootstrap</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#error-estándar-bootstrap-e-intervalos-normales"><i class="fa fa-check"></i>Error estándar bootstrap e intervalos normales</a><ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-tomadores-de-té-negro"><i class="fa fa-check"></i>Ejemplo: tomadores de té negro</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-inventario-de-casas-vendidas"><i class="fa fa-check"></i>Ejemplo: inventario de casas vendidas</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#calibración-de-intervalos-de-confianza"><i class="fa fa-check"></i>Calibración de intervalos de confianza</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#interpretación-de-intervalos-de-confianza"><i class="fa fa-check"></i>Interpretación de intervalos de confianza</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#intervalos-bootstrap-de-percentiles"><i class="fa fa-check"></i>Intervalos bootstrap de percentiles</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-para-dos-muestras"><i class="fa fa-check"></i>Bootstrap para dos muestras</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#datos-pareados"><i class="fa fa-check"></i>Datos pareados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-otras-estadísticas"><i class="fa fa-check"></i>Bootstrap y otras estadísticas</a><ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-estimadores-de-razón"><i class="fa fa-check"></i>Ejemplo: estimadores de razón</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-suavizadores"><i class="fa fa-check"></i>Ejemplo: suavizadores</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-estimadores-complejos-tablas-de-perfiles"><i class="fa fa-check"></i>Bootstrap y estimadores complejos: tablas de perfiles</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-muestras-complejas"><i class="fa fa-check"></i>Bootstrap y muestras complejas</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#conclusiones-y-observaciones"><i class="fa fa-check"></i>Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="S-max-verosimilitud.html"><a href="S-max-verosimilitud.html"><i class="fa fa-check"></i><b>7</b> Estimación por máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="S-max-verosimilitud.html"><a href="S-max-verosimilitud.html#introducción-a-estimación-por-máxima-verosimilitud"><i class="fa fa-check"></i>Introducción a estimación por máxima verosimilitud</a></li>
<li class="chapter" data-level="" data-path="S-max-verosimilitud.html"><a href="S-max-verosimilitud.html#máxima-verosimilitud-para-observaciones-continuas"><i class="fa fa-check"></i>Máxima verosimilitud para observaciones continuas</a></li>
<li class="chapter" data-level="" data-path="S-max-verosimilitud.html"><a href="S-max-verosimilitud.html#aspectos-numéricos"><i class="fa fa-check"></i>Aspectos numéricos</a><ul>
<li class="chapter" data-level="" data-path="S-max-verosimilitud.html"><a href="S-max-verosimilitud.html#el-método-de-momentos"><i class="fa fa-check"></i>El método de momentos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="S-max-verosimilitud.html"><a href="S-max-verosimilitud.html#máxima-verosimilitud-para-más-de-un-parámetro"><i class="fa fa-check"></i>Máxima verosimilitud para más de un parámetro</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html"><i class="fa fa-check"></i><b>8</b> <em>Bootstrap</em> paramétrico</a><ul>
<li><a href="bootstrap-paramétrico.html#ventajas-y-desventajas-de-bootstrap-paramétrico">Ventajas y desventajas de <em>bootstrap</em> paramétrico</a></li>
<li class="chapter" data-level="" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html#verificando-los-supuestos-distribucionales"><i class="fa fa-check"></i>Verificando los supuestos distribucionales</a></li>
<li class="chapter" data-level="" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html#modelos-mal-identificados"><i class="fa fa-check"></i>Modelos mal identificados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#anáslisis-exploratorio"><i class="fa fa-check"></i>1. Anáslisis Exploratorio</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#loess"><i class="fa fa-check"></i>2. Loess</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#solución-series-de-tiempo"><i class="fa fa-check"></i>Solución: Series de tiempo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#tipos-de-estudio-y-pgd"><i class="fa fa-check"></i>3. Tipos de estudio y PGD</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#pruebas-de-hipótesis-visuales-y-permutación"><i class="fa fa-check"></i>4. Pruebas de hipótesis visuales y permutación</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#solución-pruebas-pareadas"><i class="fa fa-check"></i>Solución: Pruebas pareadas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#distribución-muestral-y-remuestreo"><i class="fa fa-check"></i>5. Distribución muestral y remuestreo</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#tcl-e-introducción-a-bootstrap"><i class="fa fa-check"></i>6. TCL e introducción a bootstrap</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#solución-y-discusión-de-media"><i class="fa fa-check"></i>Solución y discusión de media</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#bootstrap-en-muestras-complejas"><i class="fa fa-check"></i>8. Bootstrap en muestras complejas</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#solución"><i class="fa fa-check"></i>Solución</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#mapas"><i class="fa fa-check"></i>Mapas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#examen-parcial"><i class="fa fa-check"></i>Examen Parcial</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EST-46111: Fundamentos de Estadística con Remuestreo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="S:max-verosimilitud" class="section level1">
<h1><span class="header-section-number">Sección 7</span> Estimación por máxima verosimilitud</h1>
<p>Los ejemplos que hemos visto han sido todos de estimadores <em>plug-in</em> (o por sustitución):
si queremos saber una cantidad poblacional, y tenemos una muestra dada, entonces
calculamos la estadística de interés <em>como si la muestra fuera la población</em>. Por ejemplo,
para estimar la mediana poblacional usamos la mediana muestral, si queremos estimar
la media poblacional usamos la media muestral, y así sucesivamente. Estos estimadores
usualmente dan resultados razonables (pero hay que checar usando muestra bootstraps, por ejemplo,
y pensar lo que estamos haciendo).</p>
<p>Cuando sabemos más acerca de la población y usamos un modelo teórico es posible
hacer más: dependiendo de qué cantidades se quieren estimar, podemos construir estimadores
que sean <em>óptimos</em> en algún sentido siempre y cuando se cumplan los supuestos teóricos, como veremos ahora.</p>
<p>Por ejemplo: ¿deberíamos estimar el centro de una distribución simétrica con la
media o con la mediana, o quizá con una media recortada?</p>
<p>En esta parte construiremos la teoría básica de estimación cuando trabajamos con
modelos teóricos conocidos. El objetivo es entender <strong>las ideas básicas</strong> de estos procedimientos,
y cómo evaluar sus resultados.</p>
<p><strong>Recordatorio</strong>: las ventajas de usar modelos teóricos para describir distribuciones de
datos está en que es posible comprimir más eficientemente la información, es posible construir
modelos más complejos juntando varios de estos modelos y de sus dependencias, y de que es
posible hacer más teoría útil que nos guíe. La desventaja es que es necesario que esos supuestos teóricos sean razonables.</p>
<div id="introducción-a-estimación-por-máxima-verosimilitud" class="section level2 unnumbered">
<h2>Introducción a estimación por máxima verosimilitud</h2>
<p>Uno de los procedimientos más estándar en esta situación es el <strong>método
de máxima verosimilitud</strong>. Los estimadores de máxima verosimilitud tienen propiedades
convenientes, y dan en general resultados razonables siempre y cuando los supuestos
sean razonables.</p>
<p><strong>Máxima verosimilitud es un proceso intuitivo, y consiste en aprender o estimar valores de parámetros desconocidos suponiendo para los datos su explicación más probable</strong>. Para
esto, usando supuestos y modelos requeriremos calcular la probabilidad de un conjunto
de observaciones.</p>
<p><strong>Ejemplo.</strong> Adaptado de <span class="citation">(Chihara and Hesterberg <a href="#ref-Chihara" role="doc-biblioref">2018</a>)</span>. Supongamos que una máquina produce dos tipos de bolsas de 25 galletas: la mitad de las veces produce una bolsa con 5 galletas de avena y 20 de chispas de chocolate, y
la otra mitad produce galletas con 23 galletas de avena y 2 de chispas de chocolate.</p>
<p>Tomamos una bolsa, y no sabemos qué tipo de bolsa es (parámetro desconocido). Extraemos al azar una de las galletas, y es de chispas de chocolate (observación).</p>
<p>Por máxima verosimilitud, inferimos que la bolsa que estamos considerando tiene 5 galletas de avena. Esto es porque es más probable observar una galleta de chispas en las bolsas que contienen 5 galletas de avena que en las bolsas que contienen 23 galletas de avena. Podemos cuantificar la probabilidad que “acertemos” en nuestra inferencia.</p>
<p>Cómo se aprecia en el ejemplo anterior, el esquema general es:</p>
<ol style="list-style-type: decimal">
<li>Existe un proceso del que podemos obtener observaciones de algún sistema
o población real.</li>
<li>Tenemos un modelo probabilístico que dice cómo se producen esas observaciones a partir del sistema o población real.</li>
<li>Usualmente este modelo tiene algunas cantidades que no conocemos, que rigen el proceso y cómo se relaciona el proceso con las observaciones.</li>
</ol>
<p>Nuestro propósito es:</p>
<ol start="4" style="list-style-type: decimal">
<li>Extraemos observaciones del proceso<br />
<span class="math display">\[x_1, x_2, \ldots, x_n.\]</span></li>
<li>Queremos aprender de los parámetros desconocidos del proceso para calcular cantidades de interés acerca del sistema o población real</li>
</ol>
<p>En principio, los modelos que consideramos pueden ser complicados y tener varias partes o parámetros. Veamos primero un ejemplo clásico con un solo parámetro, y cómo lo resolveríamos
usando máxima verosimilitud.</p>
<p><strong>Nota</strong>: Cuando decimos <em>muestra</em> en general nos referimos a observaciones
independientes obtenidas del mismo proceso (ver la sección <a href="S-distribucion-muestreo.html#S:distribucion-muestreo">5</a> para ver qué
significa que sea independientes). Este esquema es un supuesto
que simplifica mucho los cálculos, como discutimos antes. Muchas veces este supuesto
sale del diseño de la muestra o del estudio, pero en todo caso es importante considerar
si es razonable o no para nuestro problema particular.</p>
<div class="mathblock">
<p>
Denotemos por <span class="math inline"><span class="math inline">\(f(x; \theta)\)</span></span> la función de densidad para una variable aleatoria continua con párametro asociado <span class="math inline"><span class="math inline">\(\theta.\)</span></span> Denotamos por <span class="math inline"><span class="math inline">\(X_1, \ldots, X_n,\)</span></span> una muestra aleatoria de <span class="math inline"><span class="math inline">\(n\)</span></span> observaciones de esta distribución y por <span class="math inline"><span class="math inline">\(x_1, \ldots, x_n\)</span></span> los valores observados de esta muestra aleatoria.
</p>
</div>
<p><strong>Ejemplo.</strong> Supongamos que queremos saber qué proporción de registros de una base de datos tiene algún error menor de captura. No podemos revisar todos los registros, así que tomamos una muestra
de 8 registros, escogiendo uno por uno al azar de manera independiente. Revisamos los
8 registros, y obtenemos los siguientes datos:</p>
<p><span class="math display">\[x_1 = 0, x_2 = 1, x_3 = 0, x_4 = 0, x_5 =1, x_6 =0, x_7 =0, x_8 =0\]</span></p>
<p>donde 1 indica un error menor. Encontramos dos errores menores. ¿Cómo estimamos el número de
registros con errores leves en la base de datos?</p>
<p>Ya sabemos una respuesta razonable para nuestro estimador puntual, que sería <span class="math inline">\(\hat{p}=2/8=0.25\)</span>.
Veamos cómo se obtendría por máxima verosimilitud.</p>
<p>Según el proceso con el que se construyó la muestra, debemos dar una probabilidad de observar
los 2 errores en 8 registros. Supongamos que en realidad existe una proporción <span class="math inline">\(p\)</span>
de que un registro tenga un error. Entonces calculamos</p>
<p>Probabilidad de observar la muestra:</p>
<p><span class="math display">\[P(X_1 = 0, X_2 = 1, X_3 = 0, X_4 = 0, X_5 =1, X_6 =0, X_7 =0, X_8 =0)\]</span></p>
<p>es igual a</p>
<p><span class="math display">\[P(X_1 = 0)P(X_2 = 1)P(X_3 = 0)P( X_4 = 0)P(X_5 =1)P(X_6 =0)P(X_7 =0)P(X_8 =0)\]</span>
pues la probabilidad de que cada observación sea 0 o 1 no depende de las observaciones restantes (la muestra se extrajo de manera independiente).</p>
<p>Esta última cantidad tiene un parámetro que no conocemos: la proporcion <span class="math inline">\(p\)</span> de registros
con errores. Así que lo denotamos como una cantidad desconocida <span class="math inline">\(p\)</span>. Nótese
entonces que <span class="math inline">\(P(X_2=1) = p\)</span>, <span class="math inline">\(P(X_3=0) = 1-p\)</span> y así sucesivamente, así que la cantidad
de arriba es igual a</p>
<p><span class="math display">\[(1-p)p(1-p)(1-p)p(1-p)(1-p)(1-p) \]</span></p>
<p>que se simplifica a</p>
<p><span class="math display">\[ \mathcal{L}(p) = p^2(1-p)^6\]</span></p>
<p>Ahora la idea es <strong>encontrar la p que maximiza la probabilidad de lo que observamos</strong>. En
este caso se puede hacer con cálculo, pero vamos a ver una gráfica de esta función y
cómo resolverla de manera numérica.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="S-max-verosimilitud.html#cb260-1"></a>verosimilitud &lt;-<span class="st"> </span><span class="cf">function</span>(p){</span>
<span id="cb260-2"><a href="S-max-verosimilitud.html#cb260-2"></a>  p<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">^</span><span class="dv">6</span></span>
<span id="cb260-3"><a href="S-max-verosimilitud.html#cb260-3"></a>}</span>
<span id="cb260-4"><a href="S-max-verosimilitud.html#cb260-4"></a>dat_verosim &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="fl">0.001</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">prob =</span> <span class="kw">map_dbl</span>(x, verosimilitud))</span>
<span id="cb260-5"><a href="S-max-verosimilitud.html#cb260-5"></a><span class="kw">ggplot</span>(dat_verosim, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> prob)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb260-6"><a href="S-max-verosimilitud.html#cb260-6"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.25</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb260-7"><a href="S-max-verosimilitud.html#cb260-7"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;p&quot;</span>)</span></code></pre></div>
<p><img src="09-max-verosimilitud_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Nótese que esta gráfica:</p>
<ul>
<li>Depende de los datos, que pensamos fijos.</li>
<li>Cuando cambiamos la <span class="math inline">\(p\)</span>, la probabilidad de observar la muestra cambia. Nos interesa
ver las regiones donde la probabilidad es relativamente alta.</li>
<li>El máximo está en 0.25.</li>
<li>Así que el estimador de máxima verosimilitud es <span class="math inline">\(\hat{p} = 0.25\)</span>, <strong>que es también
el estimador usual de plugin</strong> en este caso.</li>
</ul>
<p>Para uniformizar la notación con el caso continuo que veremos más adelante, usaremos
la notación</p>
<p><span class="math display">\[P(X=x) = f(x)\]</span>
donde <span class="math inline">\(f\)</span> es la función de densidad (en este caso, función de masa de probabilidad) de <span class="math inline">\(X\)</span>. Si esta función depende
de un parámetro, escribimos <span class="math display">\[f(x ;\theta)\]</span></p>
<div class="mathblock">
<p>
<strong>Definición.</strong> Sean <span class="math inline"><span class="math inline">\(X_1, \ldots, X_n\)</span></span> una muestra de una densidad <span class="math inline"><span class="math inline">\(f(x; \theta)\)</span></span> y sean <span class="math inline"><span class="math inline">\(x_1,x_2,\ldots, x_n\)</span></span> los valores observados.
</p>
<p>
La <em>función de verosimilitud</em> del párametro de interés <span class="math inline"><span class="math inline">\(\theta\)</span></span> está definida por <span class="math display"><span class="math display">\[\begin{align}
\mathcal{L}(\theta; x_1, \ldots, x_n) = \prod_{i = 1}^n f(x_i; \theta). 
\end{align}\]</span></span>
</p>
<p>
Esta función nos dice qué tan creible es el valor del parámetro <span class="math inline"><span class="math inline">\(\theta\)</span></span> dada la muestra observada. A veces también la denotamos por <span class="math inline"><span class="math inline">\(\mathcal{L}_n(\theta)\)</span></span>.
</p>
</div>
<p>Ahora definimos qué es un estimador de máxima verosimilitud.</p>
<div class="mathblock">
<p>
<strong>Definición.</strong> Un estimador de máxima verosimilitud lo denotamos por <span class="math inline"><span class="math inline">\(\hat \theta_{\textsf{MLE}}\)</span></span> y es un valor que satisface <span class="math display"><span class="math display">\[\begin{align}
\hat \theta_{\textsf{MLE}} =  \underset{\theta \, \in \, \Theta}{\arg\max}\,  \mathcal{L}(\theta; x_1, \ldots, x_n),
\end{align}\]</span></span> donde <span class="math inline"><span class="math inline">\(\theta\)</span></span> denota el espacio parametral. Es decir, el espacio válido de búsqueda congruente con la definición del modelo.
</p>
</div>
<div class="ejercicio">
<ul>
<li>
Considera el caso de una normal con media y varianza desconocidas. ¿Cuáles son los espacios parametrales para efectuar <span class="math inline"><span class="math inline">\(\mathsf{MLE}\)</span></span>?
</li>
<li>
Considera el caso de una Binomial con parámetros <span class="math inline"><span class="math inline">\(N\)</span></span> y <span class="math inline"><span class="math inline">\(p\)</span></span> desconocidos. ¿Cuáles son los espacios parametrales para la búsqueda del <span class="math inline"><span class="math inline">\(\mathsf{MLE}\)</span></span>?
</li>
</ul>
</div>
<p>Obsérvese que para construir la verosimilitud y en consecuencia buscar por
estimadores de máxima verosimlitud necesitamos:</p>
<ul>
<li>Un modelo teórico de cómo es la población con parámetros e<br />
</li>
<li>Información de cómo se extrajo la muestra,</li>
</ul>
<p>y entonces podemos resolver nuestro problema de estimación
convirtiéndolo en uno de optimización.</p>
<p>Probamos esta idea con un proceso más complejo.</p>
<p><strong>Ejemplo.</strong> Supongamos que una máquina puede estar funcionando correctamente o no en cada
corrida. Cada corrida se producen 500 productos, y se muestrean 10 para
detectar defectos. Cuando la máquina funciona correctamente, la tasa de defectos
es de 3%. Cuando la máquina no está funcionando correctamente la tasa de defectos
es de 20%</p>
<p>Supongamos que escogemos al azar 11 corridas, y obervamos los siguientes
número de defectuosos:</p>
<p><span class="math display">\[1, 0, 0, 3 ,0, 0, 0, 2, 1, 0, 0\]</span></p>
<p>La pregunta es: ¿qué porcentaje del tiempo la máquina está funcionando correctamente?</p>
<p>Primero pensemos en una corrida. La probabilidad de observar una sucesión particular de
<span class="math inline">\(r\)</span> defectos es</p>
<p><span class="math display">\[0.03^r(0.97)^{(10-r)}\]</span>
cuando la máquina está funcionando correctamente.</p>
<p>Si la máquina está fallando, la misma probabilidad es</p>
<p><span class="math display">\[0.2^r(0.8)^{(10-r)}.\]</span></p>
<p>Ahora supongamos que la máquina trabaja
correctamente en una proporción <span class="math inline">\(p\)</span> de las corridas. Entonces la probabilidad
de observar <span class="math inline">\(r\)</span> fallas se calcula promediando (probabilidad
total) sobre las probabilidades de que la máquina esté funcionando
bien o no:</p>
<p><span class="math display">\[0.03^r(0.97)^{(10-r)}p + 0.2^r(0.8)^{(10-r)}(1-p)\]</span>
Y esta es nuestra función de verosimilitud para una observación.</p>
<p>Suponemos que las <span class="math inline">\(r_1,r_2, \ldots, r_{11}\)</span> observaciones son independientes
(por ejemplo, después de cada corrida la máquina se prepara de una manera estándar,
y es como si el proceso comenzara otra vez). Entonces tenemos que multiplicar
estas probabilidades para cada observación <span class="math inline">\(r_1\)</span>:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="S-max-verosimilitud.html#cb261-1"></a>calc_verosim &lt;-<span class="st"> </span><span class="cf">function</span>(r){</span>
<span id="cb261-2"><a href="S-max-verosimilitud.html#cb261-2"></a>  q_func &lt;-<span class="st"> </span><span class="fl">0.03</span><span class="op">^</span>r<span class="op">*</span>(<span class="fl">0.97</span>)<span class="op">^</span>(<span class="dv">10</span><span class="op">-</span>r)</span>
<span id="cb261-3"><a href="S-max-verosimilitud.html#cb261-3"></a>  q_falla &lt;-<span class="st"> </span><span class="fl">0.2</span><span class="op">^</span>r<span class="op">*</span>(<span class="fl">0.8</span>)<span class="op">^</span>(<span class="dv">10</span><span class="op">-</span>r)</span>
<span id="cb261-4"><a href="S-max-verosimilitud.html#cb261-4"></a>  <span class="cf">function</span>(p){</span>
<span id="cb261-5"><a href="S-max-verosimilitud.html#cb261-5"></a>    <span class="co">#nota: esta no es la mejor manera de calcularlo, hay </span></span>
<span id="cb261-6"><a href="S-max-verosimilitud.html#cb261-6"></a>    <span class="co"># que usar logaritmos.</span></span>
<span id="cb261-7"><a href="S-max-verosimilitud.html#cb261-7"></a>    <span class="kw">prod</span>(p<span class="op">*</span>q_func <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">*</span>q_falla)</span>
<span id="cb261-8"><a href="S-max-verosimilitud.html#cb261-8"></a>  }</span>
<span id="cb261-9"><a href="S-max-verosimilitud.html#cb261-9"></a>}</span>
<span id="cb261-10"><a href="S-max-verosimilitud.html#cb261-10"></a>verosim &lt;-<span class="st"> </span><span class="kw">calc_verosim</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb261-11"><a href="S-max-verosimilitud.html#cb261-11"></a><span class="kw">verosim</span>(<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 2.692087e-14</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="S-max-verosimilitud.html#cb263-1"></a>dat_verosim &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="fl">0.001</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">prob =</span> <span class="kw">map_dbl</span>(x, verosim))</span>
<span id="cb263-2"><a href="S-max-verosimilitud.html#cb263-2"></a><span class="kw">ggplot</span>(dat_verosim, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> prob)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb263-3"><a href="S-max-verosimilitud.html#cb263-3"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.8</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb263-4"><a href="S-max-verosimilitud.html#cb263-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;prop funcionado&quot;</span>)</span></code></pre></div>
<p><img src="09-max-verosimilitud_files/figure-html/unnamed-chunk-5-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Y nuestra estimación puntual sería de alrededor de 80%.</p>
</div>
<div id="máxima-verosimilitud-para-observaciones-continuas" class="section level2 unnumbered">
<h2>Máxima verosimilitud para observaciones continuas</h2>
<p>Cuando las observaciones <span class="math inline">\(x_1,\ldots, x_n\)</span> provienen de una distribución
continua, no tiene sentido considerar <span class="math inline">\(P(X = x_i)\)</span>, pues siempre es igual
a cero.</p>
<p>Sin embargo, podemos
escribir para pequeños valores <span class="math inline">\(\epsilon \ll 1\)</span>
<span class="math display">\[\begin{align}
  P(x - \epsilon &lt; X &lt; x + \epsilon | \theta) = \int_{x - \epsilon}^{x + \epsilon} f(t; \theta) \, \text{d} t \approx 2 \epsilon f(x; \theta),
\end{align}\]</span>
donde <span class="math inline">\(f(x; \theta)\)</span> es la función de densidad de <span class="math inline">\(X.\)</span> Por lo tanto,
<span class="math display">\[\begin{align}
\begin{split}
  P&amp;(x_1 - \epsilon &lt; X_1 &lt; x_1 + \epsilon, \ldots, x_n - \epsilon &lt; X_n &lt; x_n + \epsilon | \theta) \\
  &amp;= \prod_{i = 1}^n P(x_i - \epsilon &lt; X_i &lt; x_i + \epsilon | \theta) \\
  &amp;= \prod_{i = 1}^n 2 \epsilon f(x_i; \theta) = (2\epsilon)^n \prod_{i = 1}^n f(x_i; \theta).
\end{split}
\end{align}\]</span></p>
<p>Notemos que si <span class="math inline">\(\epsilon \rightarrow 0\)</span> la ecuación rápidamente converge a cero. Pero para pequeños
valores de <span class="math inline">\(\epsilon\)</span> la ecuación que nos interesa es proporcional a <span class="math inline">\(\prod_{i = 1}^n f(x_i; \theta).\)</span></p>
<p>De esta forma, nuestra definición de máxima verosimilitud y estimadores
de máxima verosimilitud es la misma para el caso continuo (verifica las definiciones
de la sección anterior).</p>
<p><strong>Ejemplo.</strong> Supongamos que tenemos una muestra <span class="math inline">\(x_1\ldots, x_n\)</span> extraidas de una distribución
exponencial con tasa <span class="math inline">\(\lambda&gt;0\)</span> donde no conocemos <span class="math inline">\(\lambda\)</span>. ¿Cuál es
el estimador de máxima verosimilitud de <span class="math inline">\(\lambda\)</span>?</p>
<p>Para <span class="math inline">\(\lambda&gt;0\)</span>, tenemos que</p>
<p><span class="math display">\[{\mathcal L}(\lambda) = \prod_{i=1}^n \lambda e^{-\lambda x_i}\]</span>
de modo que</p>
<p><span class="math display">\[{\mathcal L}(\lambda) = \lambda^n e^{-\lambda \sum_{i=1}^nx_i} = \lambda^n e^{-n\lambda\bar{x}} = e^{n(\log\lambda - \lambda\bar{x})}\]</span>
Que podemos maximizar usando cálculo para obtener
<span class="math inline">\(\hat{\lambda}_{\mathsf{ML}} = \frac{1}{\bar{x}}\)</span> (demuéstralo). Discute
por qué esto es intuitivamente razonable: ¿cuál es
el valor esperado de una exponencial con parámetro <span class="math inline">\(\lambda\)</span>?</p>
</div>
<div id="aspectos-numéricos" class="section level2 unnumbered">
<h2>Aspectos numéricos</h2>
<p>Encontrar el estimador de máxima verosimilitud (<span class="math inline">\(\textsf{MLE}\)</span>) es automático en la mayoría de los casos.
En teoría, podemos reutilizar la misma rutina numérica para encontrar el estimador sin ninguna ayuda de la analista.
Esto contrasta con otras técnicas de estimación en donde se requieren cálculos y manipulación de ecuaciones.</p>
<p>Sin embargo, hay situaciones que se pueden evitar de manera general. Por ejemplo, cuando calculamos la verosimilitud arriba, nótese que estamos multiplicando
números que pueden ser muy chicos (por ejemplo <span class="math inline">\(p^6\)</span>, etc). Esto puede producir
desbordes numéricos fácilmente. Por ejemplo para un tamaño de muestra de 1000, podríamos
tener que calcular</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="S-max-verosimilitud.html#cb264-1"></a>p &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb264-2"><a href="S-max-verosimilitud.html#cb264-2"></a>proba &lt;-<span class="st"> </span>(p <span class="op">^</span><span class="st"> </span><span class="dv">800</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">^</span><span class="dv">200</span></span>
<span id="cb264-3"><a href="S-max-verosimilitud.html#cb264-3"></a>proba</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>En estos casos, es mejor hacer los cálculos en escala logarítmica. El logaritmo
convierte productos en sumas, y baja exponentes multiplicando. Si calculamos en escala
logaritmica la cantidad de arriba, no tenemos problema:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="S-max-verosimilitud.html#cb266-1"></a>log_proba &lt;-<span class="st"> </span><span class="dv">800</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(p) <span class="op">+</span><span class="st"> </span><span class="dv">200</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p)</span>
<span id="cb266-2"><a href="S-max-verosimilitud.html#cb266-2"></a>log_proba</span></code></pre></div>
<pre><code>## [1] -1863.14</code></pre>
<p>Ahora notemos que</p>
<ul>
<li>Maximizar la verosimilitud <strong>es lo mismo</strong> que maximizar la log-verosimilitud, pues el logaritmo es una función creciente. Si <span class="math inline">\(x_{\max}\)</span> es el máximo de <span class="math inline">\(f\)</span>, tenemos que <span class="math inline">\(f(x_{\max})&gt;f(x)\)</span> para cualquier <span class="math inline">\(x\)</span>, entonces tomando logaritmo,
<span class="math display">\[\log(f(x_{max}))&gt;\log(f(x)),\]</span> para cualquier <span class="math inline">\(x.\)</span> Pues el logaritmo respeta la desigualdad por ser creciente.</li>
<li>Usualmente usamos la log-verosimilitud para encontrar el estimador de máxima verosimilitud.</li>
<li>Hay razónes teóricas y de interpretación por las que también es conveniente hacer esto.</li>
</ul>
<div class="mathblock">
<p>
<strong>Definición.</strong> La log-verosimilitud la denotamos usualmente por <span class="math display"><span class="math display">\[\ell_n(\theta) = \log \left(\mathcal{L}_n(\theta)\right),\]</span></span> donde hemos suprimido la dependencia en la muestra por conveniencia.
</p>
</div>
<div class="ejercicio">
<p>
Considera una muestra de variables aleatorias Gaussianas con media <span class="math inline"><span class="math inline">\(\mu\)</span></span> y varianza <span class="math inline"><span class="math inline">\(\sigma^2.\)</span></span> Escribe la verosimilitud para una muestra de tamaño <span class="math inline"><span class="math inline">\(n,\)</span></span> y después escribe la función de log-verosimilitud.
</p>
</div>
<p><strong>Ejemplo.</strong> En nuestro primer ejemplo,</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="S-max-verosimilitud.html#cb268-1"></a>log_verosimilitud &lt;-<span class="st"> </span><span class="cf">function</span>(p){</span>
<span id="cb268-2"><a href="S-max-verosimilitud.html#cb268-2"></a>  <span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(p) <span class="op">+</span><span class="st"> </span><span class="dv">6</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p)</span>
<span id="cb268-3"><a href="S-max-verosimilitud.html#cb268-3"></a>}</span>
<span id="cb268-4"><a href="S-max-verosimilitud.html#cb268-4"></a>dat_verosim &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="fl">0.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">log_prob =</span> <span class="kw">map_dbl</span>(x, log_verosimilitud))</span>
<span id="cb268-5"><a href="S-max-verosimilitud.html#cb268-5"></a><span class="kw">ggplot</span>(dat_verosim, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> log_prob)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb268-6"><a href="S-max-verosimilitud.html#cb268-6"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.25</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb268-7"><a href="S-max-verosimilitud.html#cb268-7"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;p&quot;</span>)</span></code></pre></div>
<p><img src="09-max-verosimilitud_files/figure-html/unnamed-chunk-9-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Obtenemos el mismo máximo. Podemos incluso resolver numéricamente:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="S-max-verosimilitud.html#cb269-1"></a>solucion &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="dt">p =</span> <span class="fl">0.5</span>, log_verosimilitud, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">fnscale =</span> <span class="dv">-1</span>))</span>
<span id="cb269-2"><a href="S-max-verosimilitud.html#cb269-2"></a>solucion<span class="op">$</span>par</span></code></pre></div>
<pre><code>## [1] 0.25</code></pre>
<p>Y en nuestro segundo ejemplo:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="S-max-verosimilitud.html#cb271-1"></a>calc_log_verosim &lt;-<span class="st"> </span><span class="cf">function</span>(r){</span>
<span id="cb271-2"><a href="S-max-verosimilitud.html#cb271-2"></a>  q_func &lt;-<span class="st"> </span><span class="fl">0.03</span><span class="op">^</span>r<span class="op">*</span>(<span class="fl">0.97</span>)<span class="op">^</span>(<span class="dv">10</span><span class="op">-</span>r)</span>
<span id="cb271-3"><a href="S-max-verosimilitud.html#cb271-3"></a>  q_falla &lt;-<span class="st"> </span><span class="fl">0.2</span><span class="op">^</span>r<span class="op">*</span>(<span class="fl">0.8</span>)<span class="op">^</span>(<span class="dv">10</span><span class="op">-</span>r)</span>
<span id="cb271-4"><a href="S-max-verosimilitud.html#cb271-4"></a>  <span class="cf">function</span>(p){</span>
<span id="cb271-5"><a href="S-max-verosimilitud.html#cb271-5"></a>    <span class="co">#nota: esta no es la mejor manera de calcularlo, hay </span></span>
<span id="cb271-6"><a href="S-max-verosimilitud.html#cb271-6"></a>    <span class="co"># que usar logaritmos.</span></span>
<span id="cb271-7"><a href="S-max-verosimilitud.html#cb271-7"></a>    <span class="kw">sum</span>(<span class="kw">log</span>(p<span class="op">*</span>q_func <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">*</span>q_falla))</span>
<span id="cb271-8"><a href="S-max-verosimilitud.html#cb271-8"></a>  }</span>
<span id="cb271-9"><a href="S-max-verosimilitud.html#cb271-9"></a>}</span>
<span id="cb271-10"><a href="S-max-verosimilitud.html#cb271-10"></a>log_verosim &lt;-<span class="st"> </span><span class="kw">calc_log_verosim</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb271-11"><a href="S-max-verosimilitud.html#cb271-11"></a><span class="kw">log_verosim</span>(<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] -31.24587</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="S-max-verosimilitud.html#cb273-1"></a>dat_verosim &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="fl">0.001</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">log_verosimilitud =</span> <span class="kw">map_dbl</span>(x, log_verosim))</span>
<span id="cb273-2"><a href="S-max-verosimilitud.html#cb273-2"></a><span class="kw">ggplot</span>(dat_verosim, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> log_verosimilitud)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb273-3"><a href="S-max-verosimilitud.html#cb273-3"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.775</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb273-4"><a href="S-max-verosimilitud.html#cb273-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;prop funcionado&quot;</span>)</span></code></pre></div>
<p><img src="09-max-verosimilitud_files/figure-html/unnamed-chunk-12-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>En la función de verosimilitud los datos están fijos y optimizamos con respecto a
las variables que no conocemos. ¿Cómo construimos esta función en general, para cualquier
tamaño de muestra y cualquier número de registros detectados como erróneos?</p>
<p>Nótese que la verosimilitud la consideramos <strong>función de los parámetros</strong>,
donde <strong>los datos están fijos</strong>.</p>
<p>Podemos construir una función que genera la función de verosimilitud dependiendo de los datos. En nuestro primer ejemplo de muestras de registros erróneos,
podríamos construir una función que genera la log verosimilitud dependiendo
del tamaño de muestra y del número de errores encontrado:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="S-max-verosimilitud.html#cb274-1"></a>construir_log_verosim &lt;-<span class="st"> </span><span class="cf">function</span>(n, n_err){</span>
<span id="cb274-2"><a href="S-max-verosimilitud.html#cb274-2"></a>  <span class="co"># n es tamaño de muestra </span></span>
<span id="cb274-3"><a href="S-max-verosimilitud.html#cb274-3"></a>  <span class="co"># n_err el número de errores detectados (datos)</span></span>
<span id="cb274-4"><a href="S-max-verosimilitud.html#cb274-4"></a>  n_corr &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span>n_err</span>
<span id="cb274-5"><a href="S-max-verosimilitud.html#cb274-5"></a>  log_verosim &lt;-<span class="st"> </span><span class="cf">function</span>(p){</span>
<span id="cb274-6"><a href="S-max-verosimilitud.html#cb274-6"></a>    n_err <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(p) <span class="op">+</span><span class="st"> </span>n_corr <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p)</span>
<span id="cb274-7"><a href="S-max-verosimilitud.html#cb274-7"></a>  }</span>
<span id="cb274-8"><a href="S-max-verosimilitud.html#cb274-8"></a>}</span></code></pre></div>
<p>Cuando fijamos <span class="math inline">\(n\)</span> y <span class="math inline">\(n_{\textsf{err}}\)</span>, esta función genera otra función, la log verosimilitud, que es la que queremos optimizar.</p>
<p>Supongamos entonces que sacamos 20 registros al azar y observamos 10 incorrectos. La función
de verosimilitud es</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="S-max-verosimilitud.html#cb275-1"></a>log_vero &lt;-<span class="st"> </span><span class="kw">construir_log_verosim</span>(<span class="dv">20</span>, <span class="dv">10</span>)</span></code></pre></div>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="S-max-verosimilitud.html#cb276-1"></a><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.001</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb276-2"><a href="S-max-verosimilitud.html#cb276-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_ver =</span> <span class="kw">log_vero</span>(x)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb276-3"><a href="S-max-verosimilitud.html#cb276-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> log_ver)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb276-4"><a href="S-max-verosimilitud.html#cb276-4"></a><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb276-5"><a href="S-max-verosimilitud.html#cb276-5"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="09-max-verosimilitud_files/figure-html/unnamed-chunk-15-1.png" width="480" style="display: block; margin: auto;" /></p>
<p><strong>Ejemplo.</strong> Supongamos que en una población de transacciones hay un porcentaje <span class="math inline">\(p\)</span> (desconocido)
que son fraudulentas. Tenemos un sistema de clasificación humana que que marca transacciones como sospechosas.
Con este sistema hemos medido que la proporción de transacciones normales que son marcadas como sospechosas es de 0.1%, y que la proporción de transacciones fraudulentas que son marcadas
como sospechosas es de 98%. Supongamos que extraemos una muestra de 2000 transacciones, de manera que todas ellas tiene la misma probabilidad de ser fraudulentas. El sistema de clasificación marca 4 transacciones como fraudulentas. ¿Cómo estimamos la proporción de transacciones fraudulentas en la población?</p>
<p>Solución: sea <span class="math inline">\(p\)</span> la proporción de transacciones fraudulentas. Entonces la probabilidad
de que una transacción sea marcada como sospechosa es (proba total):</p>
<p><span class="math display">\[0.98p + 0.001(1-p)\]</span></p>
<p>Pues tenemos que contar 98% de la proporción <span class="math inline">\(p\)</span> de fraudulentas
(correctamente detectadas) más 0.1% de la proporción <span class="math inline">\((1-p)\)</span> de fraudulentas.
Escribimos entonces nuestra función de verosimilitud</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="S-max-verosimilitud.html#cb277-1"></a>crear_log_verosim &lt;-<span class="st"> </span><span class="cf">function</span>(n, n_sosp){</span>
<span id="cb277-2"><a href="S-max-verosimilitud.html#cb277-2"></a>  <span class="co"># devolver la función log verosimilitud </span></span>
<span id="cb277-3"><a href="S-max-verosimilitud.html#cb277-3"></a>  log_verosimilitud_pct &lt;-<span class="st"> </span><span class="cf">function</span>(pct){</span>
<span id="cb277-4"><a href="S-max-verosimilitud.html#cb277-4"></a>    <span class="co"># sup que pct es la proporcentaje de fraudes,</span></span>
<span id="cb277-5"><a href="S-max-verosimilitud.html#cb277-5"></a>    <span class="co"># que es el parámetro que queremos estimar</span></span>
<span id="cb277-6"><a href="S-max-verosimilitud.html#cb277-6"></a>    prob_sosp &lt;-<span class="st"> </span><span class="fl">0.98</span> <span class="op">*</span><span class="st"> </span>pct <span class="op">/</span><span class="st"> </span><span class="dv">100</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.001</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pct <span class="op">/</span><span class="st"> </span><span class="dv">100</span>)</span>
<span id="cb277-7"><a href="S-max-verosimilitud.html#cb277-7"></a>    log_prob &lt;-<span class="st"> </span>n_sosp <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(prob_sosp) <span class="op">+</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>n_sosp) <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span><span class="st"> </span>prob_sosp)</span>
<span id="cb277-8"><a href="S-max-verosimilitud.html#cb277-8"></a>    log_prob</span>
<span id="cb277-9"><a href="S-max-verosimilitud.html#cb277-9"></a>  }</span>
<span id="cb277-10"><a href="S-max-verosimilitud.html#cb277-10"></a>  log_verosimilitud_pct</span>
<span id="cb277-11"><a href="S-max-verosimilitud.html#cb277-11"></a>}</span></code></pre></div>
<p>La verosimilitud es una función de <span class="math inline">\(p\)</span>.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="S-max-verosimilitud.html#cb278-1"></a>log_verosim &lt;-<span class="st"> </span><span class="kw">crear_log_verosim</span>(<span class="dt">n =</span> <span class="dv">2000</span>, <span class="dt">n_sosp =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>A continuación la mostramos de manera gráfica.</p>
<p><img src="09-max-verosimilitud_files/figure-html/unnamed-chunk-18-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>No se ve muy claro dónde ocurre el máximo, pero podemos ampliar cerca de cero la
misma gráfica:</p>
<p><img src="09-max-verosimilitud_files/figure-html/unnamed-chunk-19-1.png" width="480" style="display: block; margin: auto;" /></p>
<ul>
<li>Vemos que alrededor de 0.1% maximiza la probabilidad de haber observado 4
transacciones sospechosas.</li>
<li>Notamos sin embargo que varios valores alrededor de este valor tienen probabilidad similar,
así que también son consistentes con los datos (por ejemplo, valores como 0.05 o 0.15 tienen probabilidad similar). Tendremos que considerar esto para evaluar la incertidumbre en nuestra estimación.</li>
<li>Obsérvese adicionalmente que si no tomáramos en cuenta las probabilidades de falsos
negativos y falsos positivos la estimación simple daría <span class="math inline">\(4/2000 = 0.002\)</span> (0.2%), que es
dos veces más grande que nuestra estimación puntual por máxima verosimilitud.</li>
</ul>
<p><strong>Ejemplo.</strong> Este es un ejemplo donde mostramos que cuando el soporte
de las densidades teóricas es acotado hay que tener cuidado en la definición de la
verosimilitud. En particular, el soporte de la variable aleatoria es el párametro de interés. Supongamos
que nuestros datos son generados por medio de una distribución uniforme en el intervalo <span class="math inline">\([0,b].\)</span>
Contamos con una muestra de <span class="math inline">\(n\)</span> observaciones generadas
de manera independiente <span class="math inline">\(X_i \sim U[0,b]\)</span> para <span class="math inline">\(i= 1, \ldots, n.\)</span>
Sin embargo, no conocemos el valor de <span class="math inline">\(b\)</span>.</p>
<p>¿Cómo es la función de log verosimilitud <span class="math inline">\({\mathcal L}_n(b)\)</span> para este caso? Nótese
que cuando el parámetro <span class="math inline">\(b\)</span> es menor que alguna <span class="math inline">\(x_i\)</span>, tenemos que
<span class="math inline">\({\mathcal L}_n(b) = 0\)</span>: la verosimilitud es cero si tomamos una <span class="math inline">\(b\)</span> más chica
que algún dato, pues este valor es incosistente del todo con los datos observados.
En otro caso,</p>
<p><span class="math display">\[{\mathcal L}_n(b) = \frac{1}{b^n},\]</span>
pues la función de densidad de una uniforme en <span class="math inline">\([0,b]\)</span> es igual a <span class="math inline">\(1/b\)</span> en
el intervalo <span class="math inline">\([0,b]\)</span>, y 0 en otro caso. Podemos escribir entonces:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="S-max-verosimilitud.html#cb279-1"></a>crear_verosim &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb279-2"><a href="S-max-verosimilitud.html#cb279-2"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb279-3"><a href="S-max-verosimilitud.html#cb279-3"></a>  verosim &lt;-<span class="st"> </span><span class="cf">function</span>(b){</span>
<span id="cb279-4"><a href="S-max-verosimilitud.html#cb279-4"></a>    indicadora &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">all</span>(x <span class="op">&lt;=</span><span class="st"> </span>b), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb279-5"><a href="S-max-verosimilitud.html#cb279-5"></a>    indicadora <span class="op">/</span><span class="st"> </span>b<span class="op">^</span>n</span>
<span id="cb279-6"><a href="S-max-verosimilitud.html#cb279-6"></a>  }</span>
<span id="cb279-7"><a href="S-max-verosimilitud.html#cb279-7"></a>}</span></code></pre></div>
<p>Ahora podemos hacer máxima verosimilitud para un ejemplo:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="S-max-verosimilitud.html#cb280-1"></a><span class="kw">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb280-2"><a href="S-max-verosimilitud.html#cb280-2"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb280-3"><a href="S-max-verosimilitud.html#cb280-3"></a>verosim &lt;-<span class="st"> </span><span class="kw">crear_verosim</span>(x)</span>
<span id="cb280-4"><a href="S-max-verosimilitud.html#cb280-4"></a>res_opt &lt;-<span class="st"> </span><span class="kw">optimize</span>(verosim, <span class="kw">c</span>(<span class="op">-</span><span class="dv">1000</span>, <span class="dv">1000</span>), <span class="dt">maximum =</span> <span class="ot">TRUE</span>)</span>
<span id="cb280-5"><a href="S-max-verosimilitud.html#cb280-5"></a>res_opt<span class="op">$</span>maximum</span></code></pre></div>
<pre><code>## [1] 2.788167</code></pre>
<p>Y nótese que, como esperaríamos, este valor es el máximo de la muestra:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="S-max-verosimilitud.html#cb282-1"></a><span class="kw">max</span>(x)</span></code></pre></div>
<pre><code>## [1] 2.788158</code></pre>
<p>La gráfica de la función de verosimilitud es:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="S-max-verosimilitud.html#cb284-1"></a><span class="kw">tibble</span>(<span class="dt">b =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">0.001</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb284-2"><a href="S-max-verosimilitud.html#cb284-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">verosim_1 =</span> <span class="kw">map_dbl</span>(b, <span class="op">~</span><span class="st"> </span><span class="kw">verosim</span>(.x))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb284-3"><a href="S-max-verosimilitud.html#cb284-3"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb284-4"><a href="S-max-verosimilitud.html#cb284-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b, <span class="dt">y =</span> verosim_<span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb284-5"><a href="S-max-verosimilitud.html#cb284-5"></a><span class="st">  </span><span class="kw">geom_rug</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> x), <span class="kw">aes</span>(<span class="dt">x =</span> x), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="09-max-verosimilitud_files/figure-html/unnamed-chunk-23-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Podemos escribir en una fórmula como:</p>
<p><span class="math display">\[\begin{align}
\mathcal{L}(b; x_1, \ldots, x_n) = \prod_{i = 1}^n 1_{[0,b]}(x_i) \frac1b. 
\end{align}\]</span></p>
<p>Y podríamos resolver analíticamente como sigue:</p>
<p>Si consideramos
<span class="math display">\[ \hat b_{\textsf{MLE}} = x_{\max} = \max\{x_i\},\]</span>
notemos que cualquier valor observado necesariamente satisface
<span class="math display">\[x_i \leq \hat b_{\textsf{MLE}},\]</span>
y por lo tanto todas las funciones indicadoras están <em>encendidas</em>. El valor de la verosimilitud es igual a
<span class="math display">\[\mathcal{L}(\hat b_{\textsf{MLE}}; x_1, \ldots, x_n) = \left(\frac{1}{x_{\max}}\right)^n \geq \left (\frac1b\right )^n\]</span>
para cualquier <span class="math inline">\(b\geq x_{\max}\)</span>. Como la verosimilitud para <span class="math inline">\(b&lt;x_{\max}\)</span> es igual
a cero, esto demuestra que el máximo de la muestra es el estimador de máxima
verosimilitud de <span class="math inline">\(b\)</span>.</p>
<p><strong>Observación.</strong> Este ejemplo también tiene dificultades numéricas, pues
la verosimilitud presenta discontinuidades y regiones con derivada igual a cero, y
la mayoria de los algoritmos numéricos no tienen garantías buenas de
covergencia al máximo en estos casos.
Si aplicamos sin cuidado descenso en gradiente, por ejemplo, podríamos comenzar
incorrectamente en un valor <span class="math inline">\(b_0 &lt; x_{\max}\)</span> y el algoritmo no avanzaría
al máximo.</p>
<div id="el-método-de-momentos" class="section level3 unnumbered">
<h3>El método de momentos</h3>
<p>Un método alternativo para estimación de parámetros es el método de momentos (<span class="math inline">\(\textsf{MOM}\)</span>). Para esto
creamos un sistema de ecuaciones de cardinalidad igual al número de parámetros a estimar.
Es decir, consideramos <span class="math inline">\(\theta \in \mathbb{R}^p;\)</span> los momentos teoricos
<span class="math display">\[\begin{align}
  m_k(\theta) = \mathbb{E}_f[X^k] = \int_{\mathcal{X}} x^k \, f(x; \theta) \, \text{d} x;
\end{align}\]</span>
los momentos empíricos
<span class="math display">\[\begin{align}
  \hat m_k(\theta) = \frac1n \sum_{i = 1}^n X_i^k;
\end{align}\]</span>
y creamos el siguiente sistema de ecuaciones:
<span class="math display">\[\begin{align}
  m_k(\theta) = \hat m_k(\theta), \qquad k = 1, \ldots, p.
\end{align}\]</span>
Este sistema explota la aproximación <span class="math inline">\(m_k(\theta) \approx \hat m_k(\theta),\)</span> cuya justificación está determinada
por la <em>Ley de los grandes números.</em></p>
<strong>Ejemplo.</strong> <em>(continuación).</em> Para el caso de <span class="math inline">\(n\)</span> observaciones <span class="math inline">\(X_i \sim U[0,b],\)</span> el método de momentos
arroja un estimador de la forma
<span class="math display">\[\hat b_{\textsf{MOM}} = 2 \bar X_n.\]</span>
<div class="ejercicio">
<p>
Considera el caso de una muestra de tamaño <span class="math inline"><span class="math inline">\(n = 3,\)</span></span> con observaciones <span class="math inline"><span class="math inline">\(X_1 = X_2 = 1\)</span></span> y <span class="math inline"><span class="math inline">\(X_3= 7\)</span></span>. ¿Cuál es el estimador <span class="math inline"><span class="math inline">\(\textsf{MOM}\)</span></span>? ¿Qué implicaciones tiene sobre la observación <span class="math inline"><span class="math inline">\(X_3\)</span></span>?
</p>
</div>
</div>
</div>
<div id="máxima-verosimilitud-para-más-de-un-parámetro" class="section level2 unnumbered">
<h2>Máxima verosimilitud para más de un parámetro</h2>
<p>Si nuestro modelo contiene más de un parámetro desconocido podemos también usar
máxima verosimilitud. En este caso, optimizamos sobre todos los parámetros usando
cálculo o alguna rutina numérica</p>
<p><strong>Ejemplo.</strong> Supongamos que en una población de estudiantes tenemos dos tipos: unos llenaron un
examen de opción múltiple al azar (1 de 5), y otros contestaron las preguntas intentando
sacar una buena calificación. Suponemos que una vez que conocemos el tipo de
estudiante, todas las preguntas tienen la misma probabilidad de ser contestadas
correctamente, de manera independiente. El modelo
teórico está representado por la siguiente simulación:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="S-max-verosimilitud.html#cb285-1"></a>sim_formas &lt;-<span class="st"> </span><span class="cf">function</span>(p_azar, p_corr){</span>
<span id="cb285-2"><a href="S-max-verosimilitud.html#cb285-2"></a>  tipo &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_azar)</span>
<span id="cb285-3"><a href="S-max-verosimilitud.html#cb285-3"></a>  <span class="cf">if</span>(tipo<span class="op">==</span><span class="dv">0</span>){</span>
<span id="cb285-4"><a href="S-max-verosimilitud.html#cb285-4"></a>    <span class="co"># al azar</span></span>
<span id="cb285-5"><a href="S-max-verosimilitud.html#cb285-5"></a>    x &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb285-6"><a href="S-max-verosimilitud.html#cb285-6"></a>  } <span class="cf">else</span> {</span>
<span id="cb285-7"><a href="S-max-verosimilitud.html#cb285-7"></a>    <span class="co"># no al azar</span></span>
<span id="cb285-8"><a href="S-max-verosimilitud.html#cb285-8"></a>    x &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dv">10</span>, p_corr)</span>
<span id="cb285-9"><a href="S-max-verosimilitud.html#cb285-9"></a>  }</span>
<span id="cb285-10"><a href="S-max-verosimilitud.html#cb285-10"></a>  x</span>
<span id="cb285-11"><a href="S-max-verosimilitud.html#cb285-11"></a>}</span></code></pre></div>
<p>Y una muestra se ve como sigue:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="S-max-verosimilitud.html#cb286-1"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb286-2"><a href="S-max-verosimilitud.html#cb286-2"></a>muestra &lt;-<span class="st"> </span><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">200</span>, <span class="op">~</span><span class="st"> </span><span class="kw">sim_formas</span>(<span class="fl">0.3</span>, <span class="fl">0.75</span>))</span>
<span id="cb286-3"><a href="S-max-verosimilitud.html#cb286-3"></a><span class="kw">qplot</span>(muestra)</span></code></pre></div>
<p><img src="09-max-verosimilitud_files/figure-html/unnamed-chunk-26-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Supongamos que no conocemos la probabildad de contestar correctamente ni la
proporción de estudiantes que contestó al azar. ¿Como estimamos estas dos cantidades?</p>
<p>Escribimos la verosimilitud:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="S-max-verosimilitud.html#cb287-1"></a>crear_log_p &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb287-2"><a href="S-max-verosimilitud.html#cb287-2"></a></span>
<span id="cb287-3"><a href="S-max-verosimilitud.html#cb287-3"></a>  log_p &lt;-<span class="st"> </span><span class="cf">function</span>(pars){</span>
<span id="cb287-4"><a href="S-max-verosimilitud.html#cb287-4"></a>    p_azar =<span class="st"> </span>pars[<span class="dv">1</span>]</span>
<span id="cb287-5"><a href="S-max-verosimilitud.html#cb287-5"></a>    p_corr =<span class="st"> </span>pars[<span class="dv">2</span>]</span>
<span id="cb287-6"><a href="S-max-verosimilitud.html#cb287-6"></a>    <span class="kw">sum</span>(<span class="kw">log</span>(p_azar <span class="op">*</span><span class="st"> </span><span class="kw">dbinom</span>(x, <span class="dv">10</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_azar) <span class="op">*</span><span class="st"> </span><span class="kw">dbinom</span>(x, <span class="dv">10</span>, p_corr)))</span>
<span id="cb287-7"><a href="S-max-verosimilitud.html#cb287-7"></a>  }  </span>
<span id="cb287-8"><a href="S-max-verosimilitud.html#cb287-8"></a>  log_p</span>
<span id="cb287-9"><a href="S-max-verosimilitud.html#cb287-9"></a>}</span></code></pre></div>
<p>Creamos la función de verosimilitud con los datos</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="S-max-verosimilitud.html#cb288-1"></a>log_p &lt;-<span class="st"> </span><span class="kw">crear_log_p</span>(muestra)</span></code></pre></div>
<p>y optimizamos</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="S-max-verosimilitud.html#cb289-1"></a>res &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), log_p, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">fnscale =</span> <span class="dv">-1</span>))</span>
<span id="cb289-2"><a href="S-max-verosimilitud.html#cb289-2"></a>res<span class="op">$</span>par</span></code></pre></div>
<pre><code>## [1] 0.2827061 0.7413276</code></pre>
<p>En este caso, obtenemos estimaciones razonables de ambos parámetros.
Nota: dependiendo de los datos, este problema
puede estar mal condicionado. Por ejemplo, ¿qué pasa si la probabilidad de acertar
cuando se contesta bien está cercano al azar?</p>
<p><strong>Ejemplo.</strong> (Tomado de <span class="citation">(Zuev <a href="#ref-zuev" role="doc-biblioref">2018</a>)</span>). Considera el caso de <span class="math inline">\(n\)</span> muestras iid de un modelo Gaussiano. Es decir,
<span class="math inline">\(X_1, \ldots, X_n \sim \mathsf{N}(\mu, \sigma^2).\)</span> Consideremos que ambos parámetros son desconocidos y nos gustaria
encontrar el <span class="math inline">\(\textsf{MLE}\)</span>. Para este problema denotamos <span class="math inline">\(\theta \in \mathbb{R}^2\)</span>, donde <span class="math inline">\(\theta_1 = \mu\)</span> y <span class="math inline">\(\theta_2 = \sigma^2.\)</span></p>
<p>La función de verosimiltud se puede calcular (ignorando algunas constantes multiplicativas) como
<span class="math display">\[\begin{align}
\mathcal{L}_n(\theta) &amp;= \prod_{i = 1}^n \frac{1}{\sigma} \, \exp\left( - \frac{(x_i - \mu)^2}{2\sigma^2}\right) \\
  &amp;= \theta_2^{-\frac{n}{2}}\exp\left( - \frac{1}{2 \theta_2} \sum_{i = 1}^n (x_i - \theta_1)^2 \right).
\end{align}\]</span></p>
<p>A continuación mostramos la representación gráfica de la función de verosimilitud de este ejemplo.
Notamos lo mismo que para los ejemplos anteriores. Conforme más datos tenemos, más nos acercamos a los valores
reales que no conocemos.</p>
<p><img src="images/mle-normal.png" width="937" style="display: block; margin: auto;" /></p>
<p>En las siguientes secciones veremos los métodos clásicos para encontrar el <span class="math inline">\(\textsf{MLE}\)</span>. Y mas adelante, estudiaremos los propiedades teóricas que hacen a estos estimadores tan útiles y prácticos en aplicaciones.</p>
<p><strong>Ejemplo</strong>. Como ejercicio, podemos encontrar los estimadores de máxima
verosimilitud cuando tenemos una muestra <span class="math inline">\(X_1, \ldots, X_n \sim \mathsf{N}(\mu, \sigma^2).\)</span>
(puedes derivar e igualar el cero para encontrar el mínimo). También podemos resolver numéricamente,
por ejemplo:</p>
<p>Supongamos que tenemos la siguiente muestra:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="S-max-verosimilitud.html#cb291-1"></a><span class="kw">set.seed</span>(<span class="dv">41852</span>)</span>
<span id="cb291-2"><a href="S-max-verosimilitud.html#cb291-2"></a>muestra &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">150</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>La función generadora de la log verosimilitud para una muestra es (ve la expresión
del ejercicio anterior y calcula su logaritmo), y generamos la función de verosimilitud
para nuestra muestra:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="S-max-verosimilitud.html#cb292-1"></a>crear_log_p &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb292-2"><a href="S-max-verosimilitud.html#cb292-2"></a>  log_p &lt;-<span class="st"> </span><span class="cf">function</span>(pars){</span>
<span id="cb292-3"><a href="S-max-verosimilitud.html#cb292-3"></a>    media =<span class="st"> </span>pars[<span class="dv">1</span>]</span>
<span id="cb292-4"><a href="S-max-verosimilitud.html#cb292-4"></a>    desv_est =<span class="st"> </span>pars[<span class="dv">2</span>]</span>
<span id="cb292-5"><a href="S-max-verosimilitud.html#cb292-5"></a>    n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb292-6"><a href="S-max-verosimilitud.html#cb292-6"></a>    <span class="co"># ve la ecuación del ejercicio anterior</span></span>
<span id="cb292-7"><a href="S-max-verosimilitud.html#cb292-7"></a>    z &lt;-<span class="st"> </span>(x <span class="op">-</span><span class="st"> </span>media) <span class="op">/</span><span class="st"> </span>desv_est</span>
<span id="cb292-8"><a href="S-max-verosimilitud.html#cb292-8"></a>    log_verosim &lt;-<span class="st"> </span><span class="op">-</span>(<span class="kw">log</span>(desv_est) <span class="op">+</span><span class="st">  </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(z<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb292-9"><a href="S-max-verosimilitud.html#cb292-9"></a>    log_verosim</span>
<span id="cb292-10"><a href="S-max-verosimilitud.html#cb292-10"></a>  }  </span>
<span id="cb292-11"><a href="S-max-verosimilitud.html#cb292-11"></a>  log_p</span>
<span id="cb292-12"><a href="S-max-verosimilitud.html#cb292-12"></a>}</span>
<span id="cb292-13"><a href="S-max-verosimilitud.html#cb292-13"></a>log_p &lt;-<span class="st"> </span><span class="kw">crear_log_p</span>(muestra)</span></code></pre></div>
<p>Ahora optimizamos (checa que el método converge):</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="S-max-verosimilitud.html#cb293-1"></a>res &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), log_p, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">fnscale =</span> <span class="dv">-1</span>, <span class="dt">maxit =</span> <span class="dv">1000</span>), <span class="dt">method =</span> <span class="st">&quot;Nelder-Mead&quot;</span>)</span>
<span id="cb293-2"><a href="S-max-verosimilitud.html#cb293-2"></a>res<span class="op">$</span>convergence</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="S-max-verosimilitud.html#cb295-1"></a>est_mv &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">parametro =</span> <span class="kw">c</span>(<span class="st">&quot;media&quot;</span>, <span class="st">&quot;sigma&quot;</span>), <span class="dt">estimador =</span> res<span class="op">$</span>par) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb295-2"><a href="S-max-verosimilitud.html#cb295-2"></a><span class="st">  </span><span class="kw">column_to_rownames</span>(<span class="dt">var =</span> <span class="st">&quot;parametro&quot;</span>)</span>
<span id="cb295-3"><a href="S-max-verosimilitud.html#cb295-3"></a>est_mv</span></code></pre></div>
<pre><code>##       estimador
## media  1.136001
## sigma  1.838421</code></pre>
<p>Verifica que el estimador de la media y de la desviación estándar
es el que esperábamos (y que puedes derivar analíticamente):</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="S-max-verosimilitud.html#cb297-1"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(muestra)</span>
<span id="cb297-2"><a href="S-max-verosimilitud.html#cb297-2"></a>sd_n &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sqrt</span>( <span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb297-3"><a href="S-max-verosimilitud.html#cb297-3"></a><span class="kw">c</span>(<span class="dt">media =</span> <span class="kw">mean</span>(muestra), <span class="dt">sigma =</span> <span class="kw">sd_n</span>(muestra)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  media  sigma 
## 1.1364 1.8392</code></pre>
<p>La siguiente pregunta qué nos interesa hacer es: ¿cómo estimamos la variabilidad
de estos estimadores? Más adelante veremos una respuesta basada en teoría, pero
también podemos resolver este problema usando el bootstrap.</p>

</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-Chihara">
<p>Chihara, Laura M., and Tim C. Hesterberg. 2018. <em>Mathematical Statistics with Resampling and R</em>. 2nd ed. Hoboken, NJ: John Wiley &amp; Sons. <a href="https://sites.google.com/site/chiharahesterberg/home">https://sites.google.com/site/chiharahesterberg/home</a>.</p>
</div>
<div id="ref-zuev">
<p>Zuev, Konstantin. 2018. “Statistical Inference.” <em>Available at SSRN 3125891</em>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intervalos-de-confianza-y-remuestreo.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bootstrap-paramétrico.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/fundamentos/edit/master/09-max-verosimilitud.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["fundamentos-estadistica.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
